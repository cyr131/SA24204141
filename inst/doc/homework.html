<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Yiran Chen" />

<meta name="date" content="2024-12-07" />

<title>All my homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">All my homework</h1>
<h4 class="author">Yiran Chen</h4>
<h4 class="date">2024-12-07</h4>



<div id="hw1" class="section level1">
<h1>hw1</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>3.4Develop an algorithm to generate random samples from a Rayleigh(σ)
distribution. Generate Rayleigh(σ) samples for several choices of σ &gt;
0 and check that the mode of the generated samples is close to the
theoretical mode σ (check the histogram).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="cf">function</span>(c,<span class="at">n=</span><span class="dv">1000</span>){</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>c<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u)) <span class="co">#逆变换生成所需分布</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="co">#画直方图比较</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),<span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;参数取值为&quot;</span>,c))</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, .<span class="dv">01</span>)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="fu">lines</span>(v, v<span class="sc">/</span>(c<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>v<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>c<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>}  <span class="co">#看图可见所生随机数契合分布</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">R</span>(<span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">R</span>(<span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA81BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZrY6AAA6ADo6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmOmZmZjpmZmZmZpBmkLZmkNtmtrZmtttmtv+QOgCQOjqQZgCQZjqQZmaQZpCQkJCQkLaQkNuQtpCQtraQttuQ27aQ2/+2ZgC2Zjq2kDq2kGa2kJC2tpC2tra2ttu2tv+229u22/+2/7a2///T09PbkDrbkGbbkJDbtmbbtpDbtrbb25Db27bb29vb2//b/9vb////tmb/tpD/trb/25D/27b/29v//7b//9v///+BNFaoAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALDklEQVR4nO2da0PbRhaGxxQv2pgUgmtaQgps6LLdZC2HxG1oUNZ0IbVaE0v//9fsXCRbkvG8umssn+dDCLI09jycmdHIRyPmE1pY0x/AdEgQgAQBSBCABAFIEIAEAUgQgAQBSBCABAFIEIAEAUgQgAQBSBCABAFIEIAEAUgQgAQBSBCABAFIEIAEAUgQgAQBSBCABAFIEIAEAZoQNDs+jG941zvj/47kv2txT/jL8+P9YXyz0zmclvvx4jQgaGZ1TiN1+rw/tNnZRefHPjuXG7zfx4Lr3v5N9DCbHXFB/Z1PvvegDv/ce8sFsW5C0OMxYyx+bAHqFzSx+J/cGy3+8PN+5xmv0d7MWtTUZXtc417sML7b6Xj8weq8GQ9CJ8KZw+L7+a7FBJ1EpOWlbkF3g523D4KJ1XmlNo16z1jnYOqICPEfxBYlqCsD6VJuVtuCCFrAY3HoBK+HeBdsZ8hfWQmsnNQtaNL79vQ16358+DJRVbjnEi7YwYD/zXmEDNjedBFB8/Gvor6q4dkyJOKC/Pf/mtqBoIdg0/xYhp7NYjvmp4E+yLuIhf8DbyXsTDShYfiKy7rja2vPu/pZbhabeEgceT+d/Lu3/2YkJfpfZYB9GLAX4ufrRMRsqCDZ/b5ju29k3frsUGx0ZZ9h8V4jjI8ggryrq6kbVNxm7DzwF2tUoUA73tI2t4kFVbo7WYwyvLN5LRWx87CfDjvp/778FNjgDUcKOo30SuHRgcDz2Huw2O8FqF2QCAPX6l52gpOeP3uv/NH+8K+r365+doMRKWhi/OdZ0OiuTwZPR5DDOvtv/WVXJXnkfkoKoNoFiUpO2O6Q12z3La+DN/4iByP+v59evouMWCKCRNzIij7+88Z+UpAIR17STaxf4+2rND91C7qzDv8YscOpYx3e84Hr4EZ0S5ese2095+N82C5CQZ69bCn2k01MnibarPOf/lJQqX7qFeRdfvtxYh3ceCO2+5GPQ2Jo9h7mgx3Z1fDOOhh5uKD7a35udDNZjkVPRpDqonn7Yssd5yW2L7/2CPLGv0z9xwHvgGa9/aBKvMJy+OI1kzX37v7B2O4Poj9aiaCEoGDsehxfR02W6aeBUez++JuzqXe9nJB595e8sX3xJ2HNRuKlmeyk/9ZnQWf+VBNbTjPchZSZmmmwzTwP8r3335/yAX7yLDoH5xF1YnV+YF1+hhQd/f/Hh3Be3wO5LRpBL9Rp80SdMapXQ1UO22hBgq+j2HT+qwwY2ez8EWPPA0Uz65vewVRGxAuxs81efBgEEaRC7bOlIokH4LPS5qYr1CvIG1+f9E7efIlsef+Sd9f+3bFS9vsvoblZr/cqeqjdOYv1LN7194toc63dqvzQFUUECQKQIAAJApAgAAkCkCAACQKQIAAJApAgAAkCkCAACQKQIAAJApAgAAkCkCAACQKQIAAJApAgQDZB9s4n+d1uZV/TmUcmQdLP34cig6Kk/C3zySJo3j/ikuSX4E6ZCRRGk03Que9dyC/E3ZJSA8wnWxPj0eNQBK1H5DnJEHK3p5fOOMyrnObk7RFths6DACQIkFOQQ6NYtlIWlFKcSZRcIxJUb3EGkK1GMqddl2K75YIWOe5u4j7IfMVtBFlqFMzDBOumGtstKHKRY91kdbsFUQQhnPDeG+qD1iDuxWJMc7/RtguquzgDIEEAEgQgQQASBCBBABIEIEEAuqIIoAgCkCAACQKQIAAJApAgAAkCLGo075eRs9FiQWphmTVXUvMU1xLiNSrsqO2ClKICmRstF+TKdei8i/wJiG0WtFw9rkAKa4sFzftlJGa2WdB3yk+xDOgtEFQsua61guzlJa88w/w2XDALI6ik4loDzcUAJAigajTvH4WJG8WW+GyrIFOLMwASBIhONcRjTlKsxexq7lltsyBbrE28F9xyuQZ+unQ0ez5df89qiwWJOrt8Lq+bathiAXm1pvP2JXEKQeKuZs1UQ8aNvOt5K9OA7b15vzud99c3MXnXs++J1aC3MILE9SDxdB1dF7SILqVKW1xbyFYjJ3w40bp1BbZdUN3FGcCyRvBWp2zFtYVIJ53FzLqxLqWgDbp0FBnmC3whlumCWbDbhjiKnQeVWNz6PaJaNsDR4gPqB/jMxa3dgel/N47l51s/di/Jfc8qWyHySpbPWzvR7A44iuW/Z5XdSljwk/8v8prRhmq645Al/EQFmW2opntWWcJPTJDRhiIfjTey7tTWDPYFIyjq53a1UzJUUqST7gwdMZvXGMp/zypL+LmN/SJ/N12QCA8RF9qvnnPfs8qSSpKCbo2PINHBCEHVJC+wpJEVQRsTQXah5ds050FQkJmGkn2QU+wRwOsFrfQ5qxFkpKH4KFZ4EVJwogiamImG6rlgthJAawQZaMgoQSYaSszFii6w+XQFV7rotaOYeYbCDxQ8r93Jl0cOTodZqj7IzFPr4FMs1h6dWeWPYixdJx16ioVU46hPEblapv1uPmVxqxvTC1oaMklQZAZWfpar7H3TC1oYMksQvJCRpbjVbVkEhYa2RZAanbIIuiVBQJD6/5YIUlsyCpK/mCVoefZhhCDxm0mCqisu2JBdkCmXGE0VdGvYmXRVxbHcgky5gFa1oPBndkGGGKpWECsmyARDlQh64kuvPIKMuPhRjaBFDKyvfRpBJhiqVpCm9qkEGaConPdPXOQqUVDjhqqMoJXpZx5BTRsyWZAR12ArFMSKClqaioVUvVQpKFXtU+3Cmrv+sRmClKGWCdKmA2UVJDqkTRCUMsu1AkGNzTwyvWnaLFe2Ur0SBDU0e83ynqlzFCsT1ICiLO+YOsuV3SYyEksS5DeQdl5VBCU7kJIE+bXfA5OxD0qX5VqVoCbOrbO9Rcos15WUzZIExVTJnwVrn4KKzoMqFhRK2lhBOGezuKDbetpczhL1t2SmuMJaiqDgK+rIZV1jBCVLSVww2wDqFdRiSBCg5Mlq+yh5sto+Sp5qBIWaRH43qi4Z9k2dZpWiUJN2Ke349BFUyvtunqAUk9XUhZq0S4nHw8lq6kJN2qXS4/MWatIulR6ft1CTdqn0+LyFmrRLpcfnLdSkXSo9Pm+hJu1S6fGthwQBSBCABAFIEIAEAUgQgAQBSBCABAFIEIAEAUgQoHxBuueSKOTXj/iLNbSa2sxi6Nm54pmfBRc5Ll2QWEfG1RryLvjLDnwusAuufLtd8QAUbSliCf40a/jqKFuQ+mpIu4SMWoEHLaIi1wWFb6QtRa1pU2w5m9IFpau974MoE9+8vdYKUg9A0WKmIO2DWyKAJfR5Ofo+yN35rY96MhObmAoMFB7wq0fRgPSCHJFigpZRxwMGpCFBLuij8Zqg6hko+lAVUTqziiWiNNPEUPqMLAUIkm+hXXItdX+oo5FOGq615wSpK5raq7+BtqtO29y1NDDM+ynXi9VHkMrF0Yaq+mMVWxCpiRPFtL0COJMW3VQkIefJEgzsg2Tz0Ad10H5g5KOphosnLHaqOY0WmqwCSBCABAFIEIAEAUgQgAQBSBCABAFIEIAEAUgQgAQBSBCABAFIEIAEAUgQgAQBSBCABAFIEIAEAUgQgAQBSBCABAFIEIAEAUgQwHRBIlct8ojK+jFdUPiU98YwXZDIh/6uYCZvIYwX5Nvwro5KMV9Q0VT5ghgvyLs4aXTVRuMFOd0/9KmsFWO6IJEOXTDTuRimC7JlNnSD3bTpghqHBAFIEIAEAUgQgAQBSBCABAFIEIAEAUgQgAQBSBCABAFIEIAEAUgQgAQBSBCABAFIEIAEAUgQgAQB/g8XDcRIX8ieIwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">R</span>(<span class="fl">1.7</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">R</span>(<span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>3.11Generate a random sample of size 1000 from a normal location
mixture. The components of the mixture have N(0, 1) and N(3, 1)
distributions with mixing probabilities p1 and p2 = 1 − p1. Graph the
histogram of the sample with density superimposed, for p1 = 0.75. Repeat
with different values for p1 and observe whether the empirical
distribution of the mixture appears to be bimodal. Make a conjecture
about the values of p1 that produce bimodal mixtures.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>mix<span class="ot">&lt;-</span><span class="cf">function</span>(p,<span class="at">n=</span><span class="dv">1000</span>){ <span class="co">#p=p1</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  x2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  a<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,n,<span class="at">replace =</span> T,<span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>p,p))</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  x<span class="ot">&lt;-</span>a<span class="sc">*</span>x1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>a)<span class="sc">*</span>x2</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="fu">hist</span>(x,<span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;p1取值为&quot;</span>,p))</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>}</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="fu">mix</span>(<span class="fl">0.75</span>)<span class="co">#不显双峰</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">mix</span>(<span class="fl">0.9</span>)<span class="co">#不显双峰</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">mix</span>(<span class="fl">0.7</span>)<span class="co">#不显双峰</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">mix</span>(<span class="fl">0.6</span>)<span class="co">#显双峰</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">mix</span>(<span class="fl">0.5</span>)<span class="co">#显双峰</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">mix</span>(<span class="fl">0.45</span>)<span class="co">#不明显</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">mix</span>(<span class="fl">0.3</span>)<span class="co">#不显双峰</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>多次试验p1的取值发现，当p1介于0.45~0.65之间，能看到双峰；p1偏大或偏小都看不出双峰</p>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>3.20 A compound Poisson process is a stochastic process {X(t), t ≥ 0}
that can be represented as the random sum X(t) = N( i=1 t) Yi, t ≥ 0,
where {N(t), t ≥ 0} is a Poisson process and Y1, Y2,… are iid and
independent of {N(t), t ≥ 0}. Write a program to simulate a compound
Poisson(λ)–Gamma process (Y has a Gamma distribution). Estimate the mean
and the variance of X(10) for several choices of the parameters and
compare with the theoretical values. Hint: Show that E[X(t)] = λtE[Y1]
and V ar(X(t)) = λtE[Y1 2].</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>p_g<span class="ot">&lt;-</span><span class="cf">function</span>(lambda,alpha,beta,<span class="at">t=</span><span class="dv">10</span>,<span class="at">n=</span><span class="dv">10000</span>){</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  Xt <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>    Nt <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda <span class="sc">*</span> t) <span class="co"># 生成 N(t)</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>    Yi <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(Nt, alpha, beta) <span class="co"># 生成伽马分布的随机变量</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>    Xt[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Yi) <span class="co"># 计算 X(t)</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  } <span class="co"># 模拟复合泊松-伽马过程,生成Xt</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co"># 估计均值和方差</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>estimated_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(Xt)</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>estimated_var <span class="ot">&lt;-</span> <span class="fu">var</span>(Xt)</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co"># 理论值</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>theoretical_mean <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> (alpha <span class="sc">/</span> beta)</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>theoretical_var <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> ((alpha <span class="sc">/</span> beta)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (alpha <span class="sc">/</span> beta<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;估计的 X(10) 均值:&quot;</span>, estimated_mean, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;估计的 X(10) 方差:&quot;</span>, estimated_var, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论的 X(10) 均值:&quot;</span>, theoretical_mean, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论的 X(10) 方差:&quot;</span>, theoretical_var, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>}  </span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="fu">p_g</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>)<span class="co">#参数选择：lambda:2,gamma:4,beta:2</span></span></code></pre></div>
<pre><code>## 估计的 X(10) 均值: 40.03082 
## 估计的 X(10) 方差: 101.4416 
## 理论的 X(10) 均值: 40 
## 理论的 X(10) 方差: 100</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">p_g</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="co">#参数选择：lambda:1,gamma:3,beta:1/2</span></span></code></pre></div>
<pre><code>## 估计的 X(10) 均值: 60.11594 
## 估计的 X(10) 方差: 482.4459 
## 理论的 X(10) 均值: 60 
## 理论的 X(10) 方差: 480</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">p_g</span>(<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>)<span class="co">#参数选择：lambda:5,gamma:2,beta:3</span></span></code></pre></div>
<pre><code>## 估计的 X(10) 均值: 33.33009 
## 估计的 X(10) 方差: 32.8553 
## 理论的 X(10) 均值: 33.33333 
## 理论的 X(10) 方差: 33.33333</code></pre>
</div>
</div>
<div id="hw2" class="section level1">
<h1>hw2</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3, 3)
cdf, and use the function to estimate F(x) for x = 0.1, 0.2,…, 0.9.
Compare the estimates with the values returned by the pbeta function in
R</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>Fbeta<span class="ot">&lt;-</span><span class="cf">function</span>(x,<span class="at">n=</span><span class="dv">10000</span>){</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="dv">0</span>,x)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">30</span><span class="sc">*</span>x<span class="sc">*</span><span class="fu">mean</span>(u<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>} <span class="co">#估计密度的函数</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;x=&quot;</span>,i<span class="sc">/</span><span class="dv">10</span>,<span class="st">&quot;时,&quot;</span>,<span class="st">&quot;估计值为&quot;</span>,<span class="fu">Fbeta</span>(i<span class="sc">/</span><span class="dv">10</span>),<span class="st">&quot;;pbeta值为&quot;</span>,<span class="fu">pbeta</span>(i<span class="sc">/</span><span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">3</span>)))</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;x=0.1时,估计值为0.00847526141155528;pbeta值为0.00856&quot;
## [1] &quot;x=0.2时,估计值为0.057406500602379;pbeta值为0.05792&quot;
## [1] &quot;x=0.3时,估计值为0.161834409456813;pbeta值为0.16308&quot;
## [1] &quot;x=0.4时,估计值为0.315483183130893;pbeta值为0.31744&quot;
## [1] &quot;x=0.5时,估计值为0.497810716725118;pbeta值为0.5&quot;
## [1] &quot;x=0.6时,估计值为0.681058801957226;pbeta值为0.68256&quot;
## [1] &quot;x=0.7时,估计值为0.837303323834966;pbeta值为0.83692&quot;
## [1] &quot;x=0.8时,估计值为0.945504457328872;pbeta值为0.94208&quot;
## [1] &quot;x=0.9时,估计值为0.998556864045035;pbeta值为0.99144&quot;</code></pre>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Implement a function to generate samples from a Rayleigh(σ)
distribution, using antithetic variables. What is the percent reduction
in variance?</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>f_duiou<span class="ot">&lt;-</span><span class="cf">function</span>(sigma,<span class="at">n=</span><span class="dv">1000</span>){</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  U<span class="ot">&lt;-</span><span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U))</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  x2<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(U))</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(x1,x2))</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>}  <span class="co">#对偶生成</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(sigma,<span class="at">n=</span><span class="dv">1000</span>){</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  U<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U))</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>}  <span class="co">#独立生成</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="co">#比较方差</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">5</span>)) {</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a>  a<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">var</span>(<span class="fu">f_duiou</span>(i)),<span class="dv">3</span>)</span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>  b<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">var</span>(<span class="fu">f</span>(i)),<span class="dv">3</span>)</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;sigma=&quot;</span>,i,<span class="st">&quot;时,&quot;</span>,<span class="st">&quot;对偶生成方差为&quot;</span>,a,<span class="st">&quot;;独立生成方差值为&quot;</span>,b,<span class="st">&quot;相比方差减少:&quot;</span>,<span class="fu">round</span>(((b<span class="sc">-</span>a)<span class="sc">/</span>b)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">3</span>),<span class="st">&quot;%&quot;</span>))</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;sigma=0.5时,对偶生成方差为0.104;独立生成方差值为0.105相比方差减少:0.952%&quot;
## [1] &quot;sigma=1时,对偶生成方差为0.414;独立生成方差值为0.421相比方差减少:1.663%&quot;
## [1] &quot;sigma=5时,对偶生成方差为10.351;独立生成方差值为10.516相比方差减少:1.569%&quot;</code></pre>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Find two importance functions f1 and f2 that are supported on (1, ∞)
and are ‘close’ to g(x),Which of your two importance functions should
produce the smaller variance in estimating by importance sampling?
Explain.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>two importance functions f1 and f2: <span class="math display">\[f_1=xe^{-x^2/2}\hspace{1cm}(x&gt;1)\]</span>
<span class="math display">\[f_2=\frac{1}{\sqrt
{2\pi}}e^{-x^2/2}\hspace{1cm}(x&gt;1)\]</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>a1<span class="ot">&lt;-</span><span class="fu">f</span>(<span class="dv">1</span>,<span class="dv">5000</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>a2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">15000</span>)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>a1<span class="ot">&lt;-</span>a1[a1<span class="sc">&gt;</span><span class="dv">1</span>][<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>a2<span class="ot">&lt;-</span>a2[a2<span class="sc">&gt;</span><span class="dv">1</span>][<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>g1<span class="ot">&lt;-</span>a1<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>))</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>g2<span class="ot">&lt;-</span><span class="fl">0.1587</span><span class="sc">*</span>a2<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&quot;f1为重要函数的估计均值为：&quot;</span>,<span class="fu">mean</span>(g1))</span></code></pre></div>
<pre><code>## [1] &quot;f1为重要函数的估计均值为：0.395953093796884&quot;</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&quot;f2为重要函数的估计均值为&quot;</span>,<span class="fu">mean</span>(g2))</span></code></pre></div>
<pre><code>## [1] &quot;f2为重要函数的估计均值为0.395750589981665&quot;</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&quot;f1为重要函数的估计方差为：&quot;</span>,<span class="fu">var</span>(g1))</span></code></pre></div>
<pre><code>## [1] &quot;f1为重要函数的估计方差为：0.0148768513952457&quot;</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&quot;f2为重要函数的估计方差为&quot;</span>,<span class="fu">var</span>(g2))</span></code></pre></div>
<pre><code>## [1] &quot;f2为重要函数的估计方差为0.0727565385799206&quot;</code></pre>
<p>f1(The Rayleigh density) produce the smaller variance.</p>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>apply the fast sorting algorithm to randomly permuted numbers</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.2.3</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="co">#快排函数</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>quick <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(x) <span class="sc">&lt;=</span> <span class="dv">1</span>) {</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>    pivot <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>    less <span class="ot">&lt;-</span> <span class="fu">quick</span>(x[x <span class="sc">&lt;</span> pivot])</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>    greater <span class="ot">&lt;-</span> <span class="fu">quick</span>(x[x <span class="sc">&gt;</span> pivot])</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(less, pivot, greater))</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>  }</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>}</span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a><span class="co"># 定义计算排序时间的函数</span></span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a>  numbers <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a>  a<span class="ot">&lt;-</span><span class="fu">Sys.time</span>()</span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a>  <span class="fu">quick</span>(numbers)</span>
<span id="cb32-19"><a href="#cb32-19" tabindex="-1"></a>  b<span class="ot">&lt;-</span><span class="fu">Sys.time</span>()</span>
<span id="cb32-20"><a href="#cb32-20" tabindex="-1"></a>  <span class="fu">return</span>(b<span class="sc">-</span>a)</span>
<span id="cb32-21"><a href="#cb32-21" tabindex="-1"></a>}</span>
<span id="cb32-22"><a href="#cb32-22" tabindex="-1"></a><span class="co"># 定义n的值</span></span>
<span id="cb32-23"><a href="#cb32-23" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">2</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">4</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">6</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">8</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb32-24"><a href="#cb32-24" tabindex="-1"></a></span>
<span id="cb32-25"><a href="#cb32-25" tabindex="-1"></a><span class="co"># 初始化存储计算时间的向量</span></span>
<span id="cb32-26"><a href="#cb32-26" tabindex="-1"></a>av_time <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb32-27"><a href="#cb32-27" tabindex="-1"></a></span>
<span id="cb32-28"><a href="#cb32-28" tabindex="-1"></a><span class="co"># 对每个n值进行100次模拟</span></span>
<span id="cb32-29"><a href="#cb32-29" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb32-30"><a href="#cb32-30" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> n[i]</span>
<span id="cb32-31"><a href="#cb32-31" tabindex="-1"></a>  times <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">100</span>, <span class="fu">time</span>(n1))</span>
<span id="cb32-32"><a href="#cb32-32" tabindex="-1"></a>  av_time[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(times)</span>
<span id="cb32-33"><a href="#cb32-33" tabindex="-1"></a>}</span>
<span id="cb32-34"><a href="#cb32-34" tabindex="-1"></a></span>
<span id="cb32-35"><a href="#cb32-35" tabindex="-1"></a><span class="co"># 计算n log(n)</span></span>
<span id="cb32-36"><a href="#cb32-36" tabindex="-1"></a>tn <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">log</span>(n)</span>
<span id="cb32-37"><a href="#cb32-37" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" tabindex="-1"></a><span class="co"># 绘制散点图和回归线</span></span>
<span id="cb32-39"><a href="#cb32-39" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(tn, av_time), <span class="fu">aes</span>(<span class="at">x =</span> tn, <span class="at">y =</span> av_time)) <span class="sc">+</span></span>
<span id="cb32-40"><a href="#cb32-40" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb32-41"><a href="#cb32-41" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb32-42"><a href="#cb32-42" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Scatter Plot and Regression Line&quot;</span>,</span>
<span id="cb32-43"><a href="#cb32-43" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;n log(n)&quot;</span>,</span>
<span id="cb32-44"><a href="#cb32-44" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Ave_Time (an)&quot;</span>,</span>
<span id="cb32-45"><a href="#cb32-45" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Regression model: an ~ tn&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-46"><a href="#cb32-46" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw3" class="section level1">
<h1>hw3</h1>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness
√b1 under normality by a Monte Carlo experiment. Compute the standard
error of the estimates from (2.14) using the normal approximation for
the density (with exact variance formula). Compare the estimated
quantiles with the quantiles of the large sample approximation √b1 ≈
N(0, 6/n).</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span> <span class="co">#样本量</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span> <span class="co">#模拟次数</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="co">#计算样本偏度</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n)</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>  b[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(((x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>}</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a><span class="co">#分位数估计</span></span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>qvalue<span class="ot">&lt;-</span><span class="fu">quantile</span>(b, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>))</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>qvalue</span></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## -0.1534534 -0.1320655  0.1294433  0.1628810</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co"># Compute the standard error</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>q<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>sd<span class="ot">&lt;-</span><span class="fu">sqrt</span>(q<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>q)<span class="sc">/</span>(m<span class="sc">*</span>(<span class="fu">dnorm</span>(<span class="fu">quantile</span>(b,<span class="at">probs =</span> q),<span class="dv">0</span>,<span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n)))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;the standard error of the estimates:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;the standard error of the estimates:&quot;</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>sd</span></code></pre></div>
<pre><code>##        2.5%          5%         95%       97.5% 
## 0.006821295 0.005724458 0.005406503 0.008745772</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co"># Compare the estimated quantiles with the quantiles of the large sample approximation</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;the estimated quantiles:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;the estimated quantiles:&quot;</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>qvalue</span></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## -0.1534534 -0.1320655  0.1294433  0.1628810</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;the quantiles of the large sample approximation:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;the quantiles of the large sample approximation:&quot;</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n))</span></code></pre></div>
<pre><code>## [1] -0.1518182 -0.1274098  0.1274098  0.1518182</code></pre>
<p>估计的分位数和大样本估计的分位数近似</p>
</div>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>Tests for association based on Pearson product moment correlation ρ,
Spearman’s rank correlation coefficient ρs, or Kendall’s coefficient τ,
are implemented in cor.test. Show (empirically) that the nonparametric
tests based on ρs or τ are less powerful than the correlation test when
the sampled distribution is bivariate normal. Find an example of an
alternative (a bivariate distribution (X, Y ) such that X and Y are
dependent) such that at least one of the nonparametric tests have better
empirical power than the correlation test against this alternative.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
<pre><code>## Warning: package &#39;MASS&#39; was built under R version 4.2.3</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a><span class="co"># 生成双变量正态样本</span></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)  <span class="co"># 均值</span></span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)  <span class="co"># 协方差</span></span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, mu, sd)</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>X <span class="ot">&lt;-</span> data[, <span class="dv">1</span>]</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>Y <span class="ot">&lt;-</span> data[, <span class="dv">2</span>]</span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a><span class="co"># 相关性检验</span></span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>pea <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a>spe <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a>ken <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Pearson product moment correlation:&quot;</span>,<span class="fu">round</span>(pea<span class="sc">$</span>estimate,<span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Pearson product moment correlation:0.673&quot;</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Spearman’s rank correlation coefficient:&quot;</span>,<span class="fu">round</span>(spe<span class="sc">$</span>estimate,<span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Spearman’s rank correlation coefficient:0.663&quot;</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Kendall’s coefficient:&quot;</span>,<span class="fu">round</span>(ken<span class="sc">$</span>estimate,<span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Kendall’s coefficient:0.473&quot;</code></pre>
<p>可见对于双变量正态，相关性检验估计中Pearson-test最有效。</p>
<p>对于二元t分布：</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>mean <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a><span class="co"># 生成样本</span></span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>) </span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># 样本大小</span></span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rmvt</span>(n, <span class="at">delta =</span> mean, <span class="at">sigma =</span> Sigma, <span class="at">df =</span> df)</span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a>X <span class="ot">&lt;-</span> data[, <span class="dv">1</span>]</span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a>Y <span class="ot">&lt;-</span> data[, <span class="dv">2</span>]</span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a><span class="co"># 相关性检验</span></span>
<span id="cb57-11"><a href="#cb57-11" tabindex="-1"></a>pea <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb57-12"><a href="#cb57-12" tabindex="-1"></a>spe <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb57-13"><a href="#cb57-13" tabindex="-1"></a>ken <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb57-14"><a href="#cb57-14" tabindex="-1"></a></span>
<span id="cb57-15"><a href="#cb57-15" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Pearson product moment correlation:&quot;</span>,<span class="fu">round</span>(pea<span class="sc">$</span>estimate,<span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Pearson product moment correlation:0.97&quot;</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Spearman’s rank correlation coefficient:&quot;</span>,<span class="fu">round</span>(spe<span class="sc">$</span>estimate,<span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Spearman’s rank correlation coefficient:0.903&quot;</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Kendall’s coefficient:&quot;</span>,<span class="fu">round</span>(ken<span class="sc">$</span>estimate,<span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Kendall’s coefficient:0.778&quot;</code></pre>
<p>可见当样本量比较小时，Kendall相关性检验表现出比Pearson更好的估计效果；</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>X <span class="ot">&lt;-</span> data[, <span class="dv">1</span>]</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> data[, <span class="dv">1</span>]<span class="sc">^</span><span class="dv">3</span><span class="sc">+</span>data[,<span class="dv">1</span>]</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a><span class="co"># 相关性检验</span></span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>pea <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>spe <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>ken <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a><span class="fu">print</span>(pea)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  X and Y
## t = 10.113, df = 8, p-value = 7.805e-06
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.8470043 0.9914790
## sample estimates:
##       cor 
## 0.9630433</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="fu">print</span>(spe)</span></code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  X and Y
## S = 3.6637e-14, p-value &lt; 2.2e-16
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
## rho 
##   1</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">print</span>(ken)</span></code></pre></div>
<pre><code>## 
##  Kendall&#39;s rank correlation tau
## 
## data:  X and Y
## T = 45, p-value = 5.511e-07
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
## tau 
##   1</code></pre>
<p>上述结果可见，对于非线性相关的情况，Spearman和Kendall检验相比于Pearson检验有更小的p值。</p>
</div>
<div id="question-9" class="section level2">
<h2>Question</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. Can we say the powers are different at 0.05 level?</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>The corresponding hypothesis test problem: <span class="math display">\[H_0:两种检验方法功效相同，即p_1-p_2=0\]</span>
<span class="math display">\[H_1:两种检验方法功效不同，即p_1-p_2\neq
0\]</span></p>
<p>对于上述假设检验问题，我们可以使用paired-t检验或者
McNemar检验。Z检验和两样本t检验需要两样本独立性，而在这个问题下两组检验结果具有相关性，所以不适用；而paired-t检验可以用来比较两样本相关性，McNemar检验是对配对名义数据的假设检验，常用于检验两模型的性能，因此我们选用McNemar检验。</p>
<p>选用McNemar检验，除了题目中的信息（10,000 experiments，0.651 for one
method and 0.676 for another method，0.05
level），至少还需要知道10000次实验中，同时落入两种方法的拒绝域的次数（从而才能得到2*2列联表进行McNemar检验）</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">library</span>(coin)</span></code></pre></div>
<pre><code>## Warning: package &#39;coin&#39; was built under R version 4.2.3</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="co"># 代码举例：同时落入两种方法的拒绝域的次数400</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>da <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">400</span>, <span class="dv">251</span>, <span class="dv">276</span>, <span class="dv">73</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>                <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="at">Method1 =</span> <span class="fu">c</span>(<span class="st">&quot;Positive&quot;</span>, <span class="st">&quot;Negative&quot;</span>),</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>                                <span class="at">Method2 =</span> <span class="fu">c</span>(<span class="st">&quot;Positive&quot;</span>, <span class="st">&quot;Negative&quot;</span>)))</span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a><span class="fu">print</span>(da)</span></code></pre></div>
<pre><code>##           Method2
## Method1    Positive Negative
##   Positive      400      251
##   Negative      276       73</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="co"># 进行McNemar检验</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a><span class="fu">mcnemar.test</span>(da)</span></code></pre></div>
<pre><code>## 
##  McNemar&#39;s Chi-squared test with continuity correction
## 
## data:  da
## McNemar&#39;s chi-squared = 1.093, df = 1, p-value = 0.2958</code></pre>
</div>
</div>
<div id="hw4" class="section level1">
<h1>hw4</h1>
<div id="question-10" class="section level2">
<h2>Question</h2>
<p>Of N = 1000 hypotheses, 950 are null and 50 are alternative. The
p-value under any null hypothesis is uniformly distributed (use runif),
and the p-value under any alternative hypothesis follows the beta
distribution with parameter 0.1 and 1 (use rbeta). Obtain Bonferroni
adjusted p-values and B-H adjusted p-values. Calculate FWER, FDR, and
TPR under nominal level α = 0.1 for each of the two adjustment methods
based on m = 10000 simulation replicates.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>h0<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">950</span>)</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>h1<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">50</span>)</span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>FWER1<span class="ot">&lt;-</span>FDR1<span class="ot">&lt;-</span>TPR1<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>FWER2<span class="ot">&lt;-</span>FDR2<span class="ot">&lt;-</span>TPR2<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>  h0<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">950</span>)</span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>  h1<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">50</span>,<span class="fl">0.1</span>,<span class="dv">1</span>)</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a>  h<span class="ot">&lt;-</span><span class="fu">c</span>(h0,h1)</span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a>  h_bon<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(h,<span class="at">method=</span><span class="st">&#39;bonferroni&#39;</span>)</span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a>  h_bh<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(h,<span class="at">method=</span><span class="st">&#39;fdr&#39;</span>)</span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a>  <span class="co">#计算FWER, FDR, and TPR of bonferroni</span></span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a>  h0_bon<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(h0,<span class="at">method=</span><span class="st">&#39;bonferroni&#39;</span>)</span>
<span id="cb76-15"><a href="#cb76-15" tabindex="-1"></a>  FWER1[i]<span class="ot">&lt;-</span><span class="fu">ifelse</span>(<span class="fu">any</span>(h0_bon<span class="sc">&lt;</span><span class="fl">0.1</span>),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb76-16"><a href="#cb76-16" tabindex="-1"></a>  FDR1[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(h_bon[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span><span class="fl">0.1</span>)<span class="sc">/</span><span class="fu">sum</span>(h_bon<span class="sc">&lt;</span><span class="fl">0.1</span>)</span>
<span id="cb76-17"><a href="#cb76-17" tabindex="-1"></a>  TPR1[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(h_bon[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>]<span class="sc">&lt;</span><span class="fl">0.1</span>)<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb76-18"><a href="#cb76-18" tabindex="-1"></a>  <span class="co">#计算FWER, FDR, and TPR of B-H</span></span>
<span id="cb76-19"><a href="#cb76-19" tabindex="-1"></a>  h0_bh<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(h0,<span class="at">method=</span><span class="st">&#39;fdr&#39;</span>)</span>
<span id="cb76-20"><a href="#cb76-20" tabindex="-1"></a>  FWER2[i]<span class="ot">&lt;-</span><span class="fu">ifelse</span>(<span class="fu">any</span>(h0_bh<span class="sc">&lt;</span><span class="fl">0.1</span>),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb76-21"><a href="#cb76-21" tabindex="-1"></a>  FDR2[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(h_bh[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span><span class="fl">0.1</span>)<span class="sc">/</span><span class="fu">sum</span>(h_bh<span class="sc">&lt;</span><span class="fl">0.1</span>)  <span class="do">#####</span></span>
<span id="cb76-22"><a href="#cb76-22" tabindex="-1"></a>  TPR2[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(h_bh[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>]<span class="sc">&lt;</span><span class="fl">0.1</span>)<span class="sc">/</span><span class="dv">50</span>   <span class="do">#####</span></span>
<span id="cb76-23"><a href="#cb76-23" tabindex="-1"></a>}</span>
<span id="cb76-24"><a href="#cb76-24" tabindex="-1"></a></span>
<span id="cb76-25"><a href="#cb76-25" tabindex="-1"></a><span class="co"># 将结果整理成3*2表格</span></span>
<span id="cb76-26"><a href="#cb76-26" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(FWER1),<span class="fu">mean</span>(FWER2),<span class="fu">mean</span>(FDR1),<span class="fu">mean</span>(FDR2),<span class="fu">mean</span>(TPR1),<span class="fu">mean</span>(TPR2)),<span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>,<span class="at">byrow =</span> T)</span>
<span id="cb76-27"><a href="#cb76-27" tabindex="-1"></a><span class="fu">colnames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni校正&quot;</span>, <span class="st">&quot;B-H校正&quot;</span>)</span>
<span id="cb76-28"><a href="#cb76-28" tabindex="-1"></a><span class="fu">rownames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb76-29"><a href="#cb76-29" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>##      Bonferroni校正 B-H校正
## FWER         0.0911  0.0958
## FDR          0.0045  0.0950
## TPR          0.3967  0.5611</code></pre>
</div>
<div id="question-11" class="section level2">
<h2>Question</h2>
<p>Assume that the times between failures follow an exponential model
Exp(λ). Obtain the MLE of the hazard rate λ and use bootstrap to
estimate the bias and standard error of the estimate</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survival&#39;:
## 
##     aml</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a>mle<span class="ot">&lt;-</span><span class="cf">function</span>(x,i) <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x[i])</span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>mle,<span class="at">R=</span><span class="fl">1e4</span>)</span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;lamda的MLE估计为：&quot;</span>,<span class="fu">round</span>(obj<span class="sc">$</span>t0,<span class="dv">4</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;lamda的MLE估计为：0.0093&quot;</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot; estimate the bias of the estimate：&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(obj<span class="sc">$</span>t)<span class="sc">-</span>obj<span class="sc">$</span>t0,<span class="dv">4</span>)))</span></code></pre></div>
<pre><code>## [1] &quot; estimate the bias of the estimate：0.0014&quot;</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot; estimate the standard error of the estimate：&quot;</span>,<span class="fu">round</span>(<span class="fu">sd</span>(obj<span class="sc">$</span>t),<span class="dv">4</span>)))</span></code></pre></div>
<pre><code>## [1] &quot; estimate the standard error of the estimate：0.0044&quot;</code></pre>
</div>
<div id="question-12" class="section level2">
<h2>Question</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures 1/λ by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a>me<span class="ot">&lt;-</span><span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>me,<span class="at">R=</span><span class="fl">1e4</span>)</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;四种CI分别为(区间下界 区间上界)：&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;四种CI分别为(区间下界 区间上界)：&quot;</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>ci<span class="sc">$</span>normal[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>## [1]  32.57798 182.37797</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>## [1]  24.42293 169.41667</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>] </span></code></pre></div>
<pre><code>## [1]  46.7500 191.7437</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a>ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>## [1]  57.12448 232.40698</code></pre>
<p>四种方法得到的置信区间不同，这是因为norm方法是在渐进正态假设下的区间；basic方法是基于大样本属性引导出来的，percile是直接从模拟生成的thetastar分布得到置信区间的；而BCa则是更为复杂的偏差校正和加速。它们各自方法原理不同，故生成的置信区间也有差异。</p>
</div>
</div>
<div id="hw5" class="section level1">
<h1>hw5</h1>
<div id="question-13" class="section level2">
<h2>Question</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of θ</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a>data1<span class="ot">&lt;-</span><span class="fu">data</span>(scor)</span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a><span class="co">#求jackknife的函数</span></span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a>knife<span class="ot">&lt;-</span><span class="cf">function</span>(data0){</span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">nrow</span>(data0)</span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>  ei<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,n,<span class="dv">5</span>)</span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a>    sigma<span class="ot">&lt;-</span><span class="fu">cor</span>(data0[<span class="sc">-</span>i,])</span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a>    ei[i,]<span class="ot">&lt;-</span><span class="fu">eigen</span>(sigma)<span class="sc">$</span>values</span>
<span id="cb98-9"><a href="#cb98-9" tabindex="-1"></a>  } <span class="co"># ei为特征值矩阵</span></span>
<span id="cb98-10"><a href="#cb98-10" tabindex="-1"></a>  jacktheta<span class="ot">&lt;-</span>ei[,<span class="dv">1</span>]<span class="sc">/</span>(ei[,<span class="dv">1</span>]<span class="sc">+</span>ei[,<span class="dv">2</span>]<span class="sc">+</span>ei[,<span class="dv">3</span>]<span class="sc">+</span>ei[,<span class="dv">4</span>]<span class="sc">+</span>ei[,<span class="dv">5</span>])</span>
<span id="cb98-11"><a href="#cb98-11" tabindex="-1"></a>  <span class="fu">return</span>(jacktheta)</span>
<span id="cb98-12"><a href="#cb98-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="co">#theta_hat</span></span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">cor</span>(scor)</span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>ei<span class="ot">&lt;-</span><span class="fu">eigen</span>(sigma)<span class="sc">$</span>values</span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>theta<span class="ot">&lt;-</span>ei[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(ei)</span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>thetaj<span class="ot">&lt;-</span><span class="fu">knife</span>(scor)</span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a><span class="co">#the jackknife estimates of bias </span></span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a>(<span class="fu">nrow</span>(scor)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(thetaj)<span class="sc">-</span>theta)</span></code></pre></div>
<pre><code>## [1] -0.0003778535</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="co">#the jackknife estimates of standard error of θ</span></span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a><span class="fu">sqrt</span>((<span class="fu">nrow</span>(scor)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">mean</span>((thetaj<span class="sc">-</span>theta)<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.04466686</code></pre>
</div>
<div id="question-14" class="section level2">
<h2>Question</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Repeat the analysis replacing the Log-Log
model with a cubic polynomial model. Which of the four models is
selected by the cross validation procedure? Which model is selected
according to maximum adjusted R2?</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survival&#39;:
## 
##     lung</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, .<span class="dv">1</span>) <span class="co">#sequence for plotting fits</span></span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a><span class="co">#Linear</span></span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a>L1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical)</span>
<span id="cb107-5"><a href="#cb107-5" tabindex="-1"></a><span class="fu">plot</span>(chemical, magnetic, <span class="at">main=</span><span class="st">&quot;Linear&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb107-6"><a href="#cb107-6" tabindex="-1"></a>yhat1 <span class="ot">&lt;-</span> L1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a</span>
<span id="cb107-7"><a href="#cb107-7" tabindex="-1"></a><span class="fu">lines</span>(a, yhat1, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="co">#Quadratic</span></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>L2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a><span class="fu">plot</span>(chemical, magnetic, <span class="at">main=</span><span class="st">&quot;Quadratic&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a>yhat2 <span class="ot">&lt;-</span> L2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a <span class="sc">+</span> L2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> a<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a><span class="fu">lines</span>(a, yhat2, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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z6fvtjnV4ITbr9znpzNBbjgg5Mar3DFIAvI+g6zbUX3BvE+crO6fgR+xZihww5c8Qm68KgJItndnqxc2hx3P43M/MZCnQSI/rYnfTSPYATd+LQZotDmwUTHa7ac5913u2sFX/VkfoKAmJuRa11Km0Xr9mJm2nuUxeShbXRMDUdEEZO+ku988+PzUZuDx9PWtj/UFadCvGhDtX+t5mSKnH2XicaN3raebP6lT9Y/Mul6Mn7A1uu636l2nn7OJ2414XKOAs56Bov4ua9/YvrPhz5e2ho5a5oBxBy4/honTjbHLezp+0WQViAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCgVQHyPx3GujfPA2U8uiBAuT4SJwIEtBJAtciWP+y+38qElVqmru63f9u1G3vxrmRRd3n1XWrLjQCSzyd9POx44nP3j+dI7bciof7+mSfQCRadpcibktu3AEjkxKu/++0b+bq5fxaJZN1/bzgLbfnNO5ljdxuAVJKqKG37n0yXU+mX6j/xuG4jnbU5t7uCWgegLklVA+oWYrMAUumsbSi6//eN16DTmc2oBukdtwHoHIMkIF3qESBlKRP6b6aJif7o+LRRgMTrU9X93McEpCxl5RG/1bgJQHocpEY2/HVbScaA1DhIJPa2CG8F0HpFgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCg/wN1MUdLdRK+nAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="co">#Exponential</span></span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a>L3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(magnetic) <span class="sc">~</span> chemical)</span>
<span id="cb109-3"><a href="#cb109-3" tabindex="-1"></a><span class="fu">plot</span>(chemical, magnetic, <span class="at">main=</span><span class="st">&quot;Exponential&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb109-4"><a href="#cb109-4" tabindex="-1"></a>logyhat3 <span class="ot">&lt;-</span> L3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a</span>
<span id="cb109-5"><a href="#cb109-5" tabindex="-1"></a>yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb109-6"><a href="#cb109-6" tabindex="-1"></a><span class="fu">lines</span>(a, yhat3, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="co">#cubic</span></span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a>L4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(chemical), <span class="fu">log</span>(magnetic), <span class="at">main=</span><span class="st">&quot;Cubic&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a>yhat4 <span class="ot">&lt;-</span> L4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a <span class="sc">+</span></span>
<span id="cb110-5"><a href="#cb110-5" tabindex="-1"></a>  L4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> a<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span> L4<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> a<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb110-6"><a href="#cb110-6" tabindex="-1"></a><span class="fu">lines</span>(a, yhat4, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="co"># cross validation procedure</span></span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(ironslag<span class="sc">$</span>magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb111-4"><a href="#cb111-4" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" tabindex="-1"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb111-6"><a href="#cb111-6" tabindex="-1"></a><span class="co"># fit models on leave-one-out samples</span></span>
<span id="cb111-7"><a href="#cb111-7" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb111-8"><a href="#cb111-8" tabindex="-1"></a>  y <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[<span class="sc">-</span>k]</span>
<span id="cb111-9"><a href="#cb111-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>chemical[<span class="sc">-</span>k]</span>
<span id="cb111-10"><a href="#cb111-10" tabindex="-1"></a>  </span>
<span id="cb111-11"><a href="#cb111-11" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb111-12"><a href="#cb111-12" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> ironslag<span class="sc">$</span>chemical[k]</span>
<span id="cb111-13"><a href="#cb111-13" tabindex="-1"></a>  e1[k] <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[k] <span class="sc">-</span> yhat1</span>
<span id="cb111-14"><a href="#cb111-14" tabindex="-1"></a>  </span>
<span id="cb111-15"><a href="#cb111-15" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb111-16"><a href="#cb111-16" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> ironslag<span class="sc">$</span>chemical[k] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> ironslag<span class="sc">$</span>chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb111-17"><a href="#cb111-17" tabindex="-1"></a>  e2[k] <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[k] <span class="sc">-</span> yhat2</span>
<span id="cb111-18"><a href="#cb111-18" tabindex="-1"></a>  </span>
<span id="cb111-19"><a href="#cb111-19" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb111-20"><a href="#cb111-20" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> ironslag<span class="sc">$</span>chemical[k]</span>
<span id="cb111-21"><a href="#cb111-21" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb111-22"><a href="#cb111-22" tabindex="-1"></a>  e3[k] <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[k] <span class="sc">-</span> yhat3</span>
<span id="cb111-23"><a href="#cb111-23" tabindex="-1"></a>  </span>
<span id="cb111-24"><a href="#cb111-24" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb111-25"><a href="#cb111-25" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> ironslag<span class="sc">$</span>chemical[k] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> ironslag<span class="sc">$</span>chemical[k]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> ironslag<span class="sc">$</span>chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb111-26"><a href="#cb111-26" tabindex="-1"></a>  e4[k] <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[k] <span class="sc">-</span> yhat4</span>
<span id="cb111-27"><a href="#cb111-27" tabindex="-1"></a>}</span>
<span id="cb111-28"><a href="#cb111-28" tabindex="-1"></a></span>
<span id="cb111-29"><a href="#cb111-29" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 19.556 17.852 18.442 18.178</code></pre>
<p>由结果可见，二次模型均方误差最小，选择Quadratic</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="co">#selected according to maximum adjusted R2?</span></span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a><span class="fu">summary</span>(L1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.7180 -2.4653 -0.0549  2.0401 11.7032 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   1.4026     2.5843   0.543     0.59    
## chemical      0.9158     0.1190   7.695 4.38e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.327 on 51 degrees of freedom
## Multiple R-squared:  0.5372, Adjusted R-squared:  0.5282 
## F-statistic: 59.21 on 1 and 51 DF,  p-value: 4.375e-10</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="fu">summary</span>(L2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.4335 -2.7006 -0.2754  2.5446 12.2665 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   24.49262    9.14657   2.678   0.0100 **
## chemical      -1.39334    0.88852  -1.568   0.1232   
## I(chemical^2)  0.05452    0.02081   2.620   0.0116 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.098 on 50 degrees of freedom
## Multiple R-squared:  0.5931, Adjusted R-squared:  0.5768 
## F-statistic: 36.44 on 2 and 50 DF,  p-value: 1.728e-10</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="fu">summary</span>(L3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(magnetic) ~ chemical)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.64173 -0.09555 -0.00529  0.10021  0.43117 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.112158   0.117442  17.985  &lt; 2e-16 ***
## chemical    0.041608   0.005409   7.693  4.4e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1967 on 51 degrees of freedom
## Multiple R-squared:  0.5371, Adjusted R-squared:  0.5281 
## F-statistic: 59.18 on 1 and 51 DF,  p-value: 4.399e-10</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="fu">summary</span>(L4)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2) + I(chemical^3))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.5989 -2.3477 -0.3071  2.4011 12.6523 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)    3.015851  27.719225   0.109    0.914
## chemical       1.918082   4.130269   0.464    0.644
## I(chemical^2) -0.107963   0.198982  -0.543    0.590
## I(chemical^3)  0.002551   0.003107   0.821    0.416
## 
## Residual standard error: 4.112 on 49 degrees of freedom
## Multiple R-squared:  0.5986, Adjusted R-squared:  0.574 
## F-statistic: 24.36 on 3 and 49 DF,  p-value: 8.611e-10</code></pre>
<p>四个模型的Adjusted R-squared分别为： 0.5282 ， 0.5768 ， 0.5281 ，
0.574</p>
<p>故选择第三个模型：Exponential</p>
</div>
<div id="question-15" class="section level2">
<h2>Question</h2>
<p>Implement the two-sample Cram´er-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="co"># example 8.1</span></span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;chickwts&quot;</span>)</span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(chickwts[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>,<span class="dv">1</span>]))</span>
<span id="cb121-4"><a href="#cb121-4" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb121-5"><a href="#cb121-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(chickwts[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>,<span class="dv">1</span>]))</span>
<span id="cb121-6"><a href="#cb121-6" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(y)</span></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb122-2"><a href="#cb122-2" tabindex="-1"></a>cvm_statistic <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb122-3"><a href="#cb122-3" tabindex="-1"></a>  Fn <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x)  <span class="co"># ECDF for sample x</span></span>
<span id="cb122-4"><a href="#cb122-4" tabindex="-1"></a>  Gm <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(y)  <span class="co"># ECDF for sample y</span></span>
<span id="cb122-5"><a href="#cb122-5" tabindex="-1"></a>  <span class="co"># Cramer-von Mises statistic</span></span>
<span id="cb122-6"><a href="#cb122-6" tabindex="-1"></a>  s <span class="ot">&lt;-</span> (n <span class="sc">*</span> m) <span class="sc">/</span> (n <span class="sc">+</span> m)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (</span>
<span id="cb122-7"><a href="#cb122-7" tabindex="-1"></a>    <span class="fu">sum</span>((<span class="fu">Fn</span>(x) <span class="sc">-</span> <span class="fu">Gm</span>(x))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb122-8"><a href="#cb122-8" tabindex="-1"></a>    <span class="fu">sum</span>((<span class="fu">Fn</span>(y) <span class="sc">-</span> <span class="fu">Gm</span>(y))<span class="sc">^</span><span class="dv">2</span>)   </span>
<span id="cb122-9"><a href="#cb122-9" tabindex="-1"></a>  )</span>
<span id="cb122-10"><a href="#cb122-10" tabindex="-1"></a>  <span class="fu">return</span>(s)</span>
<span id="cb122-11"><a href="#cb122-11" tabindex="-1"></a>}</span>
<span id="cb122-12"><a href="#cb122-12" tabindex="-1"></a>cvm0<span class="ot">&lt;-</span><span class="fu">cvm_statistic</span>(x,y)</span>
<span id="cb122-13"><a href="#cb122-13" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb122-14"><a href="#cb122-14" tabindex="-1"></a>cvm<span class="ot">&lt;-</span><span class="fu">numeric</span>(M)</span>
<span id="cb122-15"><a href="#cb122-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) {</span>
<span id="cb122-16"><a href="#cb122-16" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(x,y))</span>
<span id="cb122-17"><a href="#cb122-17" tabindex="-1"></a>  cvm[i]<span class="ot">&lt;-</span><span class="fu">cvm_statistic</span>(z[<span class="dv">1</span><span class="sc">:</span>m],z[(m<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(m<span class="sc">+</span>n)])</span>
<span id="cb122-18"><a href="#cb122-18" tabindex="-1"></a>}</span>
<span id="cb122-19"><a href="#cb122-19" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;p值为：&quot;</span>,<span class="fu">round</span>((<span class="fu">sum</span>(cvm<span class="sc">&gt;=</span>cvm0)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(M<span class="sc">+</span><span class="dv">1</span>),<span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;p值为：0.423&quot;</code></pre>
<p>“p值为：0.423”,故认为原假设成立，认为X、Y分布相同</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a><span class="co">#直方图</span></span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a><span class="fu">hist</span>(cvm, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;perm_stats(p=0.423)&quot;</span>,<span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">breaks =</span> <span class="st">&quot;scott&quot;</span>)</span>
<span id="cb124-3"><a href="#cb124-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>cvm0,<span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="co">#observed W2</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAYFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmkJBmtrZmtv+QOgCQZgCQkGaQtpCQ2/+2ZgC225C2///T09PbkDrb////AAD/tmb/25D//7b//9v///8kVsBdAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIMElEQVR4nO2d63qjNhRFSZo4tdPGbUNnyGDM+7/l6AoSNtpcYyH2+pEvGPnYXj4IhA8iq0mQ7NFvIHYoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBDgmwT9+p6XWQEKAowTlD//qC+HLHv6HPkyOxGk/LwJOdXpY9zL7ENQdToKSa/y3+LlC4fWqP/3Iuijvp6P8t9S5JIbpcF98KdkT4JU9hTBDNq5oOr0/EOlUNnXS+9ckDCjN6TXIeF2KWhMOAoC4SgIhKMgEI6CQDgKAuEoCISjIBCOgkA4CgLhKAiEoyAQjoJAOApyovCE2YRwFATCURAIR0EgHAWBcBQEwlEQCJeYoOrU/1vFhHB1coLquhDHecflwqUnqF7AUeqCtCL/d/fJ4RIUJH83lfUJA0o3BoRLTZDopTNtppyeQgkLqk6Dy8Yuh97yqZQFvWs/gfSROWbpabUDQUVg+yr1Lm6PGZS3uRHazVcn2UvdCtrDCTObQYBc9FR7zKDhFNmRgoJcDn+MEqTYuqDqdGx2UfAg6HrOxghSf7cuaJVwFATCpSZI1tEXdrQxP1x6gvKXr8vh1VxqMD9ccoLkdQal6H1njFTr5AXJq3lCQ40R4erkBIltSw4kqhM3MQ/vfNDT5/U878x9yoIWD0dBIFxqgsQIYthQY1i49ATls8zchEtOkLogdXKUwAmzdASNvJA5HK5OTtDcHXwnXN0RdJNfW6F9z2X/WZ4p4TqCnLOL28Kt7lhzL7Z9QcuHoyAQLjlBYiN7+crnVQilLKh8+izkaH7p+qBUBMkZFeSEEyudD9q+IHmgKAWtdEZx+4JsBuWzztonLMj0QcW8w8WUBelDxdGTb/WGS0/QAApVxFj3VxHtXFAh8kuf1d+hID0WC/bQenouVQS7P0G52XRCBWb2lJHY0RXD5zBLQ1Az51agOMpO8CZ/QttbBjlny0K/zVstYnPcmSBnBBYcatijpOt5d4KaDYtDDR8KAnyvoA2euf9eQRtMIysIXoUxJpyJlJCghcO5aijoTjgKAuEoCISjIBCOgkA4CgLhKAiEo6CbKP4Js7CgbQ04HpBBPzeVRxQEeJigrWxoDxO0lTyiIAAFAR4sKP6e6MGC4s8jCgJQECAKQTH3RFEIijmPIhKUdYa8cTDuvcCrEucIijOZxlWY2eqhsq+MaCFBEWXTmNdv6oPQPQ5nC+rZ8h5hbMzL9f9A3T1hdsOv24cexnqCBmRQHwlckjmEpsq8tw/qYyeCmiKH0Zcr7EXQZCjID3pDTJ205rGCxj2+5sNjm09vOAYKmhiUgkBQCgJBKQgEpSAQlIJAUAoCQSkoQSgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBBgSUGlO4FVCWez6rYIz57mtW4megpw+dOWD6iinamzHy4oSM4g08wi4y3g5nI5+Hut11pO9ITm5q1Otr7iehbNi6n3IV5OkC5tMJPHeAu4eW3mAR0a/BUEVwlnBekZf6bOD7mcIO994DfVbVG8/BMQ5LUeIKjMjp0KnXA697OgoDf5Dszb8hZwc7UY6oP81kM2se6LT52yfzlB+isyX5S3gJurTSgkqBMP7wG6gkYX7FgiEYTmAPVby2y4HMAn9gSVk+8VH8cmphYGb2LDel33xSfnTyyddGFqUnq7Fa81Tk/Vqn3x4Nx+gGh28+EM8lprW2iio3b9rPlp4zlQDB9Je63H9UGwZZAlhxqF3rfow5QC7mi85jUaanit8wFjByVINjfb78OPgxKFggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBIhOUPnRt3A93y3SuFtN3Fb+mt/0q/eJd9iNTZAzT1pnoS7uFtPcrSZuK39lSZFaXU68h/V2BPm2LPeriZt6K3XzRlUR0pN/kBUFXd7+O7R5Lv+p3v/Nnv8//H0SS5eDX1Aml7MP+VeWK6pqM72gV+hyFidk87T+auK2QlTV40xLoTUFHcTnUtW6smxXljFVJ/XtqvQXH8mt0FMfVDRWeSITQt82+aNZoR5sQiprsncJVRPnTtXw5ELpVQXJr1p8cfompaVJePWw+dOmkP2I0onqUOVKudCuODoh2+f1VxObys3SpFzoFrsBVhWkSgmfPvXbF4sqPdTD7R+DvbTC9jSl3KyULXdFE7J5Xn81cVv5q+5O7d5Ldgyr9kHmvZe2hjUgSO+YtRPZZYmuyiyYFfoZb92Npbea2K38VU+IWZD9QCFBkvzps+l27CbmrmhDtn1QTzWxV/mrGkUoSHUYueyDzOdEgsT6ptspM0eQWnF0QjZP6akmtpW/TsVwjH2QveZE7UaaLLgrSB/MySZHkzzZUX3pdoXZi91cxnK3mrit/M3VYeOxjnMv9pc91pG5L77FUAaVplI3F4c+aniQSyliwa5Qx0FtyIZ71cRO5W9uC/hjPA6aUeB+S9M7TX/6FLYjSI7FZoSMcCw24NOYndGwMngxmpouKJnRfHRQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMBvc+US4aGV7dkAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="question-16" class="section level2">
<h2>Question</h2>
<p>Implement the bivariate Spearman rank correlation test for
independence [255] as a permutation test.</p>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a><span class="co">#生成数据</span></span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a><span class="co"># 定义均值向量</span></span>
<span id="cb125-4"><a href="#cb125-4" tabindex="-1"></a>mean_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)  <span class="co"># 假设有两个变量，均值为0</span></span>
<span id="cb125-5"><a href="#cb125-5" tabindex="-1"></a><span class="co"># 定义协方差矩阵</span></span>
<span id="cb125-6"><a href="#cb125-6" tabindex="-1"></a>cov_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>)  <span class="co"># 假设两个变量之间的相关性为0.5</span></span>
<span id="cb125-7"><a href="#cb125-7" tabindex="-1"></a><span class="co"># 生成20个样本</span></span>
<span id="cb125-8"><a href="#cb125-8" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">20</span>, <span class="at">mu =</span> mean_vector, <span class="at">Sigma =</span> cov_matrix)</span></code></pre></div>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>x<span class="ot">&lt;-</span>samples[,<span class="dv">1</span>]</span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a>y<span class="ot">&lt;-</span>samples[,<span class="dv">2</span>]</span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a><span class="co"># the observed Spearman correlation</span></span>
<span id="cb126-4"><a href="#cb126-4" tabindex="-1"></a>cor0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb126-5"><a href="#cb126-5" tabindex="-1"></a><span class="co">#  the permutation </span></span>
<span id="cb126-6"><a href="#cb126-6" tabindex="-1"></a>perm_test_spearman <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">M =</span> <span class="dv">1000</span>) {</span>
<span id="cb126-7"><a href="#cb126-7" tabindex="-1"></a>  permuted_corrs <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb126-8"><a href="#cb126-8" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb126-9"><a href="#cb126-9" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">length</span>(x)</span>
<span id="cb126-10"><a href="#cb126-10" tabindex="-1"></a>  m <span class="ot">=</span> <span class="fu">length</span>(y)</span>
<span id="cb126-11"><a href="#cb126-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) {</span>
<span id="cb126-12"><a href="#cb126-12" tabindex="-1"></a>    permuted_index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">+</span>m), n, <span class="cn">FALSE</span>)</span>
<span id="cb126-13"><a href="#cb126-13" tabindex="-1"></a>    permuted_corrs[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(combined[permuted_index], combined[<span class="sc">-</span>permuted_index], <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb126-14"><a href="#cb126-14" tabindex="-1"></a>  }</span>
<span id="cb126-15"><a href="#cb126-15" tabindex="-1"></a>  <span class="fu">return</span>(permuted_corrs)</span>
<span id="cb126-16"><a href="#cb126-16" tabindex="-1"></a>}</span>
<span id="cb126-17"><a href="#cb126-17" tabindex="-1"></a></span>
<span id="cb126-18"><a href="#cb126-18" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb126-19"><a href="#cb126-19" tabindex="-1"></a>permuted_corrs <span class="ot">&lt;-</span> <span class="fu">perm_test_spearman</span>(x, y, M)</span>
<span id="cb126-20"><a href="#cb126-20" tabindex="-1"></a></span>
<span id="cb126-21"><a href="#cb126-21" tabindex="-1"></a><span class="co">#  p-value</span></span>
<span id="cb126-22"><a href="#cb126-22" tabindex="-1"></a>p_value_perm <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(permuted_corrs) <span class="sc">&gt;=</span> <span class="fu">abs</span>(cor0))</span>
<span id="cb126-23"><a href="#cb126-23" tabindex="-1"></a></span>
<span id="cb126-24"><a href="#cb126-24" tabindex="-1"></a><span class="co"># p-value from cor.test</span></span>
<span id="cb126-25"><a href="#cb126-25" tabindex="-1"></a>spearman_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb126-26"><a href="#cb126-26" tabindex="-1"></a></span>
<span id="cb126-27"><a href="#cb126-27" tabindex="-1"></a><span class="co"># Results</span></span>
<span id="cb126-28"><a href="#cb126-28" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Observed Spearman correlation:&quot;</span>, <span class="fu">round</span>(cor0,<span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Observed Spearman correlation: 0.644</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Permutation p-value:&quot;</span>, <span class="fu">round</span>(p_value_perm,<span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Permutation p-value: 0.001</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Spearman test p-value:&quot;</span>, <span class="fu">round</span>(spearman_test<span class="sc">$</span>p.value,<span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Spearman test p-value: 0.0028</code></pre>
</div>
</div>
<div id="hw6" class="section level1">
<h1>hw6</h1>
<div id="question-17" class="section level2">
<h2>Question</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from
a standard Cauchy distribution. Discard the first 1000 of the chain, and
compare the deciles of the generated observations with the deciles of
the standard Cauchy distribution (see qcauchy or qt with df=1).</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a><span class="co"># M-H生成Cauchy</span></span>
<span id="cb133-3"><a href="#cb133-3" tabindex="-1"></a>MH<span class="ot">&lt;-</span><span class="cf">function</span>(n,<span class="at">cut=</span><span class="dv">1000</span>){</span>
<span id="cb133-4"><a href="#cb133-4" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb133-5"><a href="#cb133-5" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb133-6"><a href="#cb133-6" tabindex="-1"></a>  U<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb133-7"><a href="#cb133-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb133-8"><a href="#cb133-8" tabindex="-1"></a>    a<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],<span class="dv">1</span>)</span>
<span id="cb133-9"><a href="#cb133-9" tabindex="-1"></a>    <span class="fu">ifelse</span>(U[i]<span class="sc">&lt;=</span>((<span class="dv">1</span><span class="sc">+</span>x[i<span class="dv">-1</span>]<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>a<span class="sc">^</span><span class="dv">2</span>)),x[i]<span class="ot">&lt;-</span>a,x[i]<span class="ot">&lt;-</span>x[i<span class="dv">-1</span>])</span>
<span id="cb133-10"><a href="#cb133-10" tabindex="-1"></a>  }</span>
<span id="cb133-11"><a href="#cb133-11" tabindex="-1"></a>  x<span class="ot">&lt;-</span>x[(cut<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]</span>
<span id="cb133-12"><a href="#cb133-12" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb133-13"><a href="#cb133-13" tabindex="-1"></a>}</span>
<span id="cb133-14"><a href="#cb133-14" tabindex="-1"></a>sim_cauchy<span class="ot">&lt;-</span><span class="fu">MH</span>(<span class="dv">5000</span>)</span>
<span id="cb133-15"><a href="#cb133-15" tabindex="-1"></a><span class="co">#比较分位数</span></span>
<span id="cb133-16"><a href="#cb133-16" tabindex="-1"></a><span class="fu">quantile</span>(sim_cauchy, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="co">#deciles of MH</span></span></code></pre></div>
<pre><code>##         10%         20%         30%         40%         50%         60% 
## -2.24832078 -1.20733834 -0.66905669 -0.31160712 -0.03116382  0.28300264 
##         70%         80%         90% 
##  0.66948716  1.26009803  2.88695235</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a><span class="fu">qt</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>),<span class="dv">1</span>) <span class="co">#deciles of the standard Cauchy distribution</span></span></code></pre></div>
<pre><code>## [1] -3.0776835 -1.3763819 -0.7265425 -0.3249197  0.0000000  0.3249197  0.7265425
## [8]  1.3763819  3.0776835</code></pre>
<p>通过分位数的比较可见，M-H算法得到的Cauchy分布跟真实类似，但比实际更集中，看起来方差偏小。</p>
</div>
<div id="question-18" class="section level2">
<h2>Question</h2>
<p>Consider the bivariate density.It can be shown (see e.g. [23]) that
for fixed a, b, n, the conditional distributions are Binomial(n, y) and
Beta(x + a, n − x + b). Use the Gibbs sampler to generate a chain with
target joint density f(x, y).</p>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb137-2"><a href="#cb137-2" tabindex="-1"></a>gibb<span class="ot">&lt;-</span><span class="cf">function</span>(m,cut,<span class="at">n=</span><span class="dv">10</span>,<span class="at">a=</span><span class="dv">1</span>,<span class="at">b=</span><span class="dv">1</span>){</span>
<span id="cb137-3"><a href="#cb137-3" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb137-4"><a href="#cb137-4" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb137-5"><a href="#cb137-5" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb137-6"><a href="#cb137-6" tabindex="-1"></a>  y[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,x[<span class="dv">1</span>]<span class="sc">+</span>a,n<span class="sc">-</span>x[<span class="dv">1</span>]<span class="sc">+</span>b)</span>
<span id="cb137-7"><a href="#cb137-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb137-8"><a href="#cb137-8" tabindex="-1"></a>    x[i]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,y[i<span class="dv">-1</span>])</span>
<span id="cb137-9"><a href="#cb137-9" tabindex="-1"></a>    y[i]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>]<span class="sc">+</span>a,n<span class="sc">-</span>x[i<span class="dv">-1</span>]<span class="sc">+</span>b)</span>
<span id="cb137-10"><a href="#cb137-10" tabindex="-1"></a>  }</span>
<span id="cb137-11"><a href="#cb137-11" tabindex="-1"></a>  x<span class="ot">&lt;-</span>x[(cut<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m]</span>
<span id="cb137-12"><a href="#cb137-12" tabindex="-1"></a>  y<span class="ot">&lt;-</span>y[(cut<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m]</span>
<span id="cb137-13"><a href="#cb137-13" tabindex="-1"></a>  f<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(x,y),<span class="at">nrow =</span> (m<span class="sc">-</span>cut),<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb137-14"><a href="#cb137-14" tabindex="-1"></a>}</span>
<span id="cb137-15"><a href="#cb137-15" tabindex="-1"></a><span class="co">#. Use the Gibbs sampler to generate a chain with target joint density f(x, y)</span></span>
<span id="cb137-16"><a href="#cb137-16" tabindex="-1"></a><span class="co"># n=10,a=1,b=1</span></span>
<span id="cb137-17"><a href="#cb137-17" tabindex="-1"></a>gib<span class="ot">&lt;-</span><span class="fu">gibb</span>(<span class="dv">5000</span>,<span class="dv">1000</span>)</span>
<span id="cb137-18"><a href="#cb137-18" tabindex="-1"></a></span>
<span id="cb137-19"><a href="#cb137-19" tabindex="-1"></a><span class="co"># 绘制马氏链折线图</span></span>
<span id="cb137-20"><a href="#cb137-20" tabindex="-1"></a><span class="fu">plot</span>(gib[,<span class="dv">1</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;f(x,y)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;index&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;random&quot;</span>)</span>
<span id="cb137-21"><a href="#cb137-21" tabindex="-1"></a><span class="fu">lines</span>(gib[,<span class="dv">2</span>],<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb137-22"><a href="#cb137-22" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-19" class="section level2">
<h2>Question</h2>
<p>For each of the above exercise, use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to Rˆ &lt; 1.2</p>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a><span class="co"># the Gelman-Rubin</span></span>
<span id="cb138-2"><a href="#cb138-2" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="cf">function</span>(samples) {</span>
<span id="cb138-3"><a href="#cb138-3" tabindex="-1"></a>  <span class="co"># samples: 一个矩阵，其中每一列代表一个链的样本，每一行代表一个参数</span></span>
<span id="cb138-4"><a href="#cb138-4" tabindex="-1"></a>  <span class="co"># φ:mean</span></span>
<span id="cb138-5"><a href="#cb138-5" tabindex="-1"></a>  k<span class="ot">&lt;-</span><span class="fu">ncol</span>(samples)</span>
<span id="cb138-6"><a href="#cb138-6" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(samples)</span>
<span id="cb138-7"><a href="#cb138-7" tabindex="-1"></a>  fi<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,n,k)</span>
<span id="cb138-8"><a href="#cb138-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb138-9"><a href="#cb138-9" tabindex="-1"></a>    fi[i,]<span class="ot">&lt;-</span><span class="fu">apply</span>(samples[<span class="dv">1</span><span class="sc">:</span>i,],<span class="dv">2</span>,mean)</span>
<span id="cb138-10"><a href="#cb138-10" tabindex="-1"></a>  }  <span class="co">#计算得φ:mean</span></span>
<span id="cb138-11"><a href="#cb138-11" tabindex="-1"></a>  fi[<span class="dv">1</span>,]<span class="ot">&lt;-</span>samples[<span class="dv">1</span>,]</span>
<span id="cb138-12"><a href="#cb138-12" tabindex="-1"></a></span>
<span id="cb138-13"><a href="#cb138-13" tabindex="-1"></a>  B<span class="ot">&lt;-</span>n<span class="sc">/</span>(k<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sum</span>((<span class="fu">apply</span>(fi,<span class="dv">2</span>,mean)<span class="sc">-</span><span class="fu">mean</span>(<span class="fu">apply</span>(fi,<span class="dv">2</span>,mean)))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb138-14"><a href="#cb138-14" tabindex="-1"></a>  W<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb138-15"><a href="#cb138-15" tabindex="-1"></a>  t<span class="ot">&lt;-</span><span class="fu">apply</span>(fi,<span class="dv">2</span>,mean)</span>
<span id="cb138-16"><a href="#cb138-16" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb138-17"><a href="#cb138-17" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb138-18"><a href="#cb138-18" tabindex="-1"></a>    W<span class="ot">&lt;-</span>W<span class="sc">+</span>(fi[j,i]<span class="sc">-</span>t[i])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb138-19"><a href="#cb138-19" tabindex="-1"></a>  }}</span>
<span id="cb138-20"><a href="#cb138-20" tabindex="-1"></a>  W<span class="ot">&lt;-</span>W<span class="sc">/</span>(k<span class="sc">*</span>(n<span class="dv">-1</span>))</span>
<span id="cb138-21"><a href="#cb138-21" tabindex="-1"></a>  R.hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(((n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">*</span>W<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>n<span class="sc">*</span>B) <span class="sc">/</span> W)</span>
<span id="cb138-22"><a href="#cb138-22" tabindex="-1"></a>  <span class="fu">return</span>(R.hat)</span>
<span id="cb138-23"><a href="#cb138-23" tabindex="-1"></a>}</span>
<span id="cb138-24"><a href="#cb138-24" tabindex="-1"></a><span class="co">#for 9.3</span></span>
<span id="cb138-25"><a href="#cb138-25" tabindex="-1"></a><span class="cf">for</span> (M <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">4000</span>,<span class="dv">6000</span>,<span class="dv">100</span>)) {</span>
<span id="cb138-26"><a href="#cb138-26" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb138-27"><a href="#cb138-27" tabindex="-1"></a>  A1<span class="ot">&lt;-</span><span class="fu">MH</span>(M,<span class="dv">0</span>)</span>
<span id="cb138-28"><a href="#cb138-28" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb138-29"><a href="#cb138-29" tabindex="-1"></a>  A2<span class="ot">&lt;-</span><span class="fu">MH</span>(M,<span class="dv">0</span>)</span>
<span id="cb138-30"><a href="#cb138-30" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb138-31"><a href="#cb138-31" tabindex="-1"></a>  A3<span class="ot">&lt;-</span><span class="fu">MH</span>(M,<span class="dv">0</span>)</span>
<span id="cb138-32"><a href="#cb138-32" tabindex="-1"></a>sam<span class="ot">&lt;-</span><span class="fu">cbind</span>(A1,A2,A3)</span>
<span id="cb138-33"><a href="#cb138-33" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">gr</span>(sam)<span class="sc">&lt;</span><span class="fl">1.2</span>){</span>
<span id="cb138-34"><a href="#cb138-34" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;M=&quot;</span>,M,<span class="st">&quot;时收敛；此时R_hat为：&quot;</span>,<span class="fu">gr</span>(sam)))</span>
<span id="cb138-35"><a href="#cb138-35" tabindex="-1"></a>  <span class="cf">break</span></span>
<span id="cb138-36"><a href="#cb138-36" tabindex="-1"></a>}</span>
<span id="cb138-37"><a href="#cb138-37" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;M=5000时收敛；此时R_hat为：1.11599556932674&quot;</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a><span class="co">#对于9.8</span></span>
<span id="cb140-2"><a href="#cb140-2" tabindex="-1"></a><span class="cf">for</span> (M <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1000</span>,<span class="dv">5000</span>,<span class="dv">100</span>)) {</span>
<span id="cb140-3"><a href="#cb140-3" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb140-4"><a href="#cb140-4" tabindex="-1"></a>  A1<span class="ot">&lt;-</span><span class="fu">gibb</span>(M,<span class="dv">0</span>)</span>
<span id="cb140-5"><a href="#cb140-5" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb140-6"><a href="#cb140-6" tabindex="-1"></a>  A2<span class="ot">&lt;-</span><span class="fu">gibb</span>(M,<span class="dv">0</span>)</span>
<span id="cb140-7"><a href="#cb140-7" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb140-8"><a href="#cb140-8" tabindex="-1"></a>  A3<span class="ot">&lt;-</span><span class="fu">gibb</span>(M,<span class="dv">0</span>)</span>
<span id="cb140-9"><a href="#cb140-9" tabindex="-1"></a>sam<span class="ot">&lt;-</span><span class="fu">cbind</span>((A1[,<span class="dv">1</span>]<span class="sc">+</span>A1[,<span class="dv">2</span>])<span class="sc">/</span><span class="dv">2</span>,(A2[,<span class="dv">1</span>]<span class="sc">+</span>A2[,<span class="dv">2</span>])<span class="sc">/</span><span class="dv">2</span>,(A3[,<span class="dv">1</span>]<span class="sc">+</span>A3[,<span class="dv">2</span>])<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb140-10"><a href="#cb140-10" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">gr</span>(sam)<span class="sc">&lt;</span><span class="fl">1.2</span>){</span>
<span id="cb140-11"><a href="#cb140-11" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;M=&quot;</span>,M,<span class="st">&quot;时收敛；此时R_hat为：&quot;</span>,<span class="fu">gr</span>(sam)))</span>
<span id="cb140-12"><a href="#cb140-12" tabindex="-1"></a>  <span class="cf">break</span></span>
<span id="cb140-13"><a href="#cb140-13" tabindex="-1"></a>}</span>
<span id="cb140-14"><a href="#cb140-14" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;M=1900时收敛；此时R_hat为：1.19857828662485&quot;</code></pre>
</div>
<div id="question-20" class="section level2">
<h2>Question</h2>
<p>Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a><span class="co">#见附件</span></span></code></pre></div>
</div>
</div>
<div id="hw7" class="section level1">
<h1>hw7</h1>
<div id="question-21" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: lower-alpha">
<li><p>Write a function to compute the kth term</p></li>
<li><p>Modify the function so that it computes and returns the
sum.</p></li>
<li><p>Evaluate the sum when a = (1, 2)T</p></li>
</ol>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a><span class="co">#第k项函数</span></span>
<span id="cb144-2"><a href="#cb144-2" tabindex="-1"></a>kterm <span class="ot">&lt;-</span> <span class="cf">function</span>(k, d, a) {</span>
<span id="cb144-3"><a href="#cb144-3" tabindex="-1"></a>  <span class="co"># 量a的欧几里得范数</span></span>
<span id="cb144-4"><a href="#cb144-4" tabindex="-1"></a>  norm_a <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb144-5"><a href="#cb144-5" tabindex="-1"></a>  <span class="co"># 第k项</span></span>
<span id="cb144-6"><a href="#cb144-6" tabindex="-1"></a>  term<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">*</span><span class="fu">exp</span>(<span class="fu">log</span>(norm_a<span class="sc">^</span>(<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>))<span class="sc">+</span><span class="fu">log</span>(<span class="fu">gamma</span>(k <span class="sc">+</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">gamma</span>((d <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>))<span class="sc">-</span><span class="fu">log</span>(<span class="fu">factorial</span>(k) <span class="sc">*</span> (<span class="dv">2</span><span class="sc">^</span>k))<span class="sc">-</span><span class="fu">log</span>((<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>))<span class="sc">-</span><span class="fu">log</span>(<span class="fu">gamma</span>(k <span class="sc">+</span> d<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)))</span>
<span id="cb144-7"><a href="#cb144-7" tabindex="-1"></a>  </span>
<span id="cb144-8"><a href="#cb144-8" tabindex="-1"></a>  <span class="fu">return</span>(term)</span>
<span id="cb144-9"><a href="#cb144-9" tabindex="-1"></a>}</span>
<span id="cb144-10"><a href="#cb144-10" tabindex="-1"></a></span>
<span id="cb144-11"><a href="#cb144-11" tabindex="-1"></a><span class="co">#求和函数</span></span>
<span id="cb144-12"><a href="#cb144-12" tabindex="-1"></a>n_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(d, a, <span class="at">n =</span> <span class="dv">100</span>) {</span>
<span id="cb144-13"><a href="#cb144-13" tabindex="-1"></a>  sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb144-14"><a href="#cb144-14" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>n) {</span>
<span id="cb144-15"><a href="#cb144-15" tabindex="-1"></a>    term <span class="ot">&lt;-</span> <span class="fu">kterm</span>(k, d, a)</span>
<span id="cb144-16"><a href="#cb144-16" tabindex="-1"></a>    sum <span class="ot">&lt;-</span> sum <span class="sc">+</span> term</span>
<span id="cb144-17"><a href="#cb144-17" tabindex="-1"></a>  }</span>
<span id="cb144-18"><a href="#cb144-18" tabindex="-1"></a>  <span class="fu">return</span>(sum)</span>
<span id="cb144-19"><a href="#cb144-19" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" tabindex="-1"></a><span class="co"># Evaluate the sum when a = (1, 2)T</span></span>
<span id="cb145-2"><a href="#cb145-2" tabindex="-1"></a><span class="co"># large n and d</span></span>
<span id="cb145-3"><a href="#cb145-3" tabindex="-1"></a><span class="fu">n_sum</span>(<span class="at">d=</span><span class="dv">100</span>, <span class="at">a=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">n=</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 0.3088054</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a><span class="co">#画出更直观的曲线逼近、</span></span>
<span id="cb147-2"><a href="#cb147-2" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb147-3"><a href="#cb147-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb147-4"><a href="#cb147-4" tabindex="-1"></a>n_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="dv">1</span>) <span class="co"># 创建一个从1到20的n值向量</span></span>
<span id="cb147-5"><a href="#cb147-5" tabindex="-1"></a>sum_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n_values, n_sum, <span class="at">d =</span> d, <span class="at">a =</span> a) <span class="co"># 计算每个n值的级数和</span></span>
<span id="cb147-6"><a href="#cb147-6" tabindex="-1"></a><span class="fu">plot</span>(n_values, sum_values, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;n&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Sum&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Sum of Series for d = 20 and a = (1, 2)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>可见在n=5后基本逼近级数值，该无穷级数求和为0.3088054。</p>
</div>
<div id="question-22" class="section level2">
<h2>Question</h2>
<p>Write a function to solve an equation</p>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a><span class="co"># 计算积分的辅助函数</span></span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a>integrate_function <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a, c_k) {</span>
<span id="cb148-3"><a href="#cb148-3" tabindex="-1"></a>  integrand <span class="ot">&lt;-</span> <span class="cf">function</span>(u) {</span>
<span id="cb148-4"><a href="#cb148-4" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> (u<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> k)<span class="sc">^</span>(<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb148-5"><a href="#cb148-5" tabindex="-1"></a>  }</span>
<span id="cb148-6"><a href="#cb148-6" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">integrate</span>(integrand, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> c_k)</span>
<span id="cb148-7"><a href="#cb148-7" tabindex="-1"></a>  <span class="fu">return</span>(result<span class="sc">$</span>value)</span>
<span id="cb148-8"><a href="#cb148-8" tabindex="-1"></a>}</span>
<span id="cb148-9"><a href="#cb148-9" tabindex="-1"></a></span>
<span id="cb148-10"><a href="#cb148-10" tabindex="-1"></a><span class="co"># 计算方程左边的函数</span></span>
<span id="cb148-11"><a href="#cb148-11" tabindex="-1"></a>left_side <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a) {</span>
<span id="cb148-12"><a href="#cb148-12" tabindex="-1"></a>  c_k <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (k<span class="dv">-1</span>) <span class="sc">/</span> (k <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb148-13"><a href="#cb148-13" tabindex="-1"></a>  integral_value <span class="ot">&lt;-</span> <span class="fu">integrate_function</span>(k<span class="dv">-1</span>, a, c_k)</span>
<span id="cb148-14"><a href="#cb148-14" tabindex="-1"></a>  (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>(k<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">/</span> (<span class="fu">sqrt</span>(pi <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">gamma</span>((k <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">*</span> integral_value</span>
<span id="cb148-15"><a href="#cb148-15" tabindex="-1"></a>}</span>
<span id="cb148-16"><a href="#cb148-16" tabindex="-1"></a></span>
<span id="cb148-17"><a href="#cb148-17" tabindex="-1"></a><span class="co"># 计算方程右边的函数</span></span>
<span id="cb148-18"><a href="#cb148-18" tabindex="-1"></a>right_side <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a) {</span>
<span id="cb148-19"><a href="#cb148-19" tabindex="-1"></a>  c_k <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb148-20"><a href="#cb148-20" tabindex="-1"></a>  integral_value <span class="ot">&lt;-</span> <span class="fu">integrate_function</span>(k, a, c_k)</span>
<span id="cb148-21"><a href="#cb148-21" tabindex="-1"></a>  (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>((k <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">/</span> (<span class="fu">sqrt</span>(pi <span class="sc">*</span> k) <span class="sc">*</span> <span class="fu">gamma</span>(k<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">*</span> integral_value</span>
<span id="cb148-22"><a href="#cb148-22" tabindex="-1"></a>}</span>
<span id="cb148-23"><a href="#cb148-23" tabindex="-1"></a></span>
<span id="cb148-24"><a href="#cb148-24" tabindex="-1"></a><span class="co">#求根</span></span>
<span id="cb148-25"><a href="#cb148-25" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k) <span class="fu">left_side</span>(k,a)<span class="sc">-</span><span class="fu">right_side</span>(k,a)</span>
<span id="cb148-26"><a href="#cb148-26" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(f,<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">4</span>),<span class="at">k=</span><span class="dv">25</span>)</span>
<span id="cb148-27"><a href="#cb148-27" tabindex="-1"></a></span>
<span id="cb148-28"><a href="#cb148-28" tabindex="-1"></a><span class="fu">unlist</span>(res)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>##          root        f.root          iter 
##  1.687346e+00 -2.656033e-10  9.000000e+00</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a><span class="fu">unlist</span>(res)[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)]</span></code></pre></div>
<pre><code>##      init.it   estim.prec 
##           NA 6.103516e-05</code></pre>
<p>可见当k=25时，方程根为1.687；</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(f,<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">1.8</span>),<span class="at">k=</span><span class="dv">4</span>)</span>
<span id="cb152-2"><a href="#cb152-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;k=4时：&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;k=4时：&quot;</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" tabindex="-1"></a><span class="fu">unlist</span>(res)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>##         root       f.root         iter 
## 1.492106e+00 1.391513e-07 5.000000e+00</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(f,<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">1.8</span>),<span class="at">k=</span><span class="dv">15</span>)</span>
<span id="cb156-2"><a href="#cb156-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;k=15时：&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;k=15时：&quot;</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" tabindex="-1"></a><span class="fu">unlist</span>(res)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>##          root        f.root          iter 
##  1.659096e+00 -3.049831e-10  5.000000e+00</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(f,<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">4</span>),<span class="at">k=</span><span class="dv">25</span>)</span>
<span id="cb160-2"><a href="#cb160-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;k=25时：&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;k=25时：&quot;</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" tabindex="-1"></a><span class="fu">unlist</span>(res)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>##          root        f.root          iter 
##  1.687346e+00 -2.656033e-10  9.000000e+00</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(f,<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">5</span>),<span class="at">k=</span><span class="dv">100</span>)</span>
<span id="cb164-2"><a href="#cb164-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;k=100时：&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;k=100时：&quot;</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" tabindex="-1"></a><span class="fu">unlist</span>(res)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>##          root        f.root          iter 
##  1.720590e+00 -2.539439e-10  8.000000e+00</code></pre>
<p>the solutions is identical with the points A(k) in Exercise 11.4.</p>
</div>
<div id="question-23" class="section level2">
<h2>Question</h2>
<p>Use the E-M algorithm to estimate λ, compare your result with the
observed data MLE (note: Yi follows a mixture distribution).</p>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" tabindex="-1"></a><span class="co"># 定义EM算法的函数</span></span>
<span id="cb168-2"><a href="#cb168-2" tabindex="-1"></a>myem <span class="ot">&lt;-</span> <span class="cf">function</span>(Yi, <span class="at">tau=</span><span class="dv">1</span>, <span class="at">max_iter =</span> <span class="dv">100</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>) {</span>
<span id="cb168-3"><a href="#cb168-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(Yi)</span>
<span id="cb168-4"><a href="#cb168-4" tabindex="-1"></a>  <span class="co"># 初始化参数</span></span>
<span id="cb168-5"><a href="#cb168-5" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(Yi)</span>
<span id="cb168-6"><a href="#cb168-6" tabindex="-1"></a>  </span>
<span id="cb168-7"><a href="#cb168-7" tabindex="-1"></a>  <span class="co"># EM算法迭代</span></span>
<span id="cb168-8"><a href="#cb168-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb168-9"><a href="#cb168-9" tabindex="-1"></a>    <span class="co"># E步：对数似然均值</span></span>
<span id="cb168-10"><a href="#cb168-10" tabindex="-1"></a>    Yi[<span class="dv">5</span>]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>lambda</span>
<span id="cb168-11"><a href="#cb168-11" tabindex="-1"></a>    Yi[<span class="dv">6</span>]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>lambda</span>
<span id="cb168-12"><a href="#cb168-12" tabindex="-1"></a>    Yi[<span class="dv">8</span>]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>lambda</span>
<span id="cb168-13"><a href="#cb168-13" tabindex="-1"></a>    </span>
<span id="cb168-14"><a href="#cb168-14" tabindex="-1"></a>    <span class="co"># M步：更新lambda的估计</span></span>
<span id="cb168-15"><a href="#cb168-15" tabindex="-1"></a>    lambda_new <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(Yi)</span>
<span id="cb168-16"><a href="#cb168-16" tabindex="-1"></a>    </span>
<span id="cb168-17"><a href="#cb168-17" tabindex="-1"></a>    <span class="co"># 检查收敛性</span></span>
<span id="cb168-18"><a href="#cb168-18" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(lambda_new <span class="sc">-</span> lambda) <span class="sc">&lt;</span> tol) {</span>
<span id="cb168-19"><a href="#cb168-19" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb168-20"><a href="#cb168-20" tabindex="-1"></a>    }</span>
<span id="cb168-21"><a href="#cb168-21" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> lambda_new</span>
<span id="cb168-22"><a href="#cb168-22" tabindex="-1"></a>  }</span>
<span id="cb168-23"><a href="#cb168-23" tabindex="-1"></a>  </span>
<span id="cb168-24"><a href="#cb168-24" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">lambda =</span> lambda, <span class="at">iterations =</span> i))</span>
<span id="cb168-25"><a href="#cb168-25" tabindex="-1"></a>}</span>
<span id="cb168-26"><a href="#cb168-26" tabindex="-1"></a></span>
<span id="cb168-27"><a href="#cb168-27" tabindex="-1"></a><span class="co"># 观察到的数据Yi</span></span>
<span id="cb168-28"><a href="#cb168-28" tabindex="-1"></a>Yi <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb168-29"><a href="#cb168-29" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb168-30"><a href="#cb168-30" tabindex="-1"></a></span>
<span id="cb168-31"><a href="#cb168-31" tabindex="-1"></a><span class="co"># 运行EM算法</span></span>
<span id="cb168-32"><a href="#cb168-32" tabindex="-1"></a>em_result <span class="ot">&lt;-</span> <span class="fu">myem</span>(Yi, tau)</span>
<span id="cb168-33"><a href="#cb168-33" tabindex="-1"></a><span class="fu">print</span>(em_result)</span></code></pre></div>
<pre><code>## $lambda
## [1] 1.037038
## 
## $iterations
## [1] 12</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" tabindex="-1"></a><span class="co">#MLE</span></span>
<span id="cb170-2"><a href="#cb170-2" tabindex="-1"></a><span class="co">#该数据对应的对数似然函数</span></span>
<span id="cb170-3"><a href="#cb170-3" tabindex="-1"></a>Y1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">0.91</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb170-4"><a href="#cb170-4" tabindex="-1"></a>fu<span class="ot">&lt;-</span><span class="cf">function</span>(x) <span class="dv">7</span><span class="sc">*</span><span class="fu">log</span>(x)<span class="sc">-</span><span class="fu">sum</span>(Y1)<span class="sc">*</span>x<span class="dv">-3</span><span class="sc">*</span>x</span>
<span id="cb170-5"><a href="#cb170-5" tabindex="-1"></a><span class="fu">optimize</span>(fu,<span class="at">lower=</span><span class="fl">0.5</span>,<span class="at">upper=</span><span class="dv">5</span>,<span class="at">maximum=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## $maximum
## [1] 1.037044
## 
## $objective
## [1] -6.745426</code></pre>
<p>可见EM算法的结果和MLE非常接近。</p>
</div>
</div>
<div id="hw8" class="section level1">
<h1>hw8</h1>
<div id="question-24" class="section level2">
<h2>Question</h2>
<p>Use the simplex algorithm to solve the following problem. Minimize 4x
+ 2y + 9z</p>
</div>
<div id="answer-24" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb172-2"><a href="#cb172-2" tabindex="-1"></a><span class="fu">library</span>(lpSolve)</span></code></pre></div>
<pre><code>## Warning: package &#39;lpSolve&#39; was built under R version 4.2.3</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" tabindex="-1"></a>f.obj <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)<span class="co">#objective.in</span></span>
<span id="cb174-2"><a href="#cb174-2" tabindex="-1"></a>f.con <span class="ot">&lt;-</span> <span class="fu">matrix</span> (<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>), </span>
<span id="cb174-3"><a href="#cb174-3" tabindex="-1"></a>                 <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)<span class="co">#const.mat</span></span>
<span id="cb174-4"><a href="#cb174-4" tabindex="-1"></a>f.dir <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;&lt;=&quot;</span>, <span class="st">&quot;&lt;=&quot;</span>)<span class="co">#const.dir</span></span>
<span id="cb174-5"><a href="#cb174-5" tabindex="-1"></a>f.rhs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb174-6"><a href="#cb174-6" tabindex="-1"></a><span class="co">#Vector of numeric values for the right-hand sides of the constraints.</span></span>
<span id="cb174-7"><a href="#cb174-7" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;x,y,z分别取：&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;x,y,z分别取：&quot;</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" tabindex="-1"></a><span class="fu">lp</span> (<span class="st">&quot;min&quot;</span>, f.obj, f.con, f.dir, f.rhs)<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## [1] 0 0 0</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;此时，目标函数达到最小值：&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;此时，目标函数达到最小值：&quot;</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" tabindex="-1"></a><span class="fu">lp</span> (<span class="st">&quot;min&quot;</span>, f.obj, f.con, f.dir, f.rhs)</span></code></pre></div>
<pre><code>## Success: the objective function is 0</code></pre>
</div>
<div id="question-25" class="section level2">
<h2>Question</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars
using the formulas stored in this list</p>
</div>
<div id="answer-25" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" tabindex="-1"></a><span class="do">##loops</span></span>
<span id="cb182-2"><a href="#cb182-2" tabindex="-1"></a><span class="co"># mtcars数据集</span></span>
<span id="cb182-3"><a href="#cb182-3" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb182-4"><a href="#cb182-4" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb182-5"><a href="#cb182-5" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb182-6"><a href="#cb182-6" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb182-7"><a href="#cb182-7" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb182-8"><a href="#cb182-8" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb182-9"><a href="#cb182-9" tabindex="-1"></a>)</span>
<span id="cb182-10"><a href="#cb182-10" tabindex="-1"></a></span>
<span id="cb182-11"><a href="#cb182-11" tabindex="-1"></a><span class="co"># 使用for语句循环</span></span>
<span id="cb182-12"><a href="#cb182-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb182-13"><a href="#cb182-13" tabindex="-1"></a>  model<span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)</span>
<span id="cb182-14"><a href="#cb182-14" tabindex="-1"></a>  <span class="fu">print</span>(model)</span>
<span id="cb182-15"><a href="#cb182-15" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" tabindex="-1"></a><span class="co"># lapply向量化</span></span>
<span id="cb184-2"><a href="#cb184-2" tabindex="-1"></a>fun<span class="ot">&lt;-</span><span class="cf">function</span>(formula) {<span class="fu">lm</span>(formula, <span class="at">data =</span> mtcars)}</span>
<span id="cb184-3"><a href="#cb184-3" tabindex="-1"></a>fits <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, fun)</span>
<span id="cb184-4"><a href="#cb184-4" tabindex="-1"></a><span class="fu">print</span>(fits)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>两种方式得到相同的结果，但lapply向量化提高运算速度，且写法更简洁。</p>
</div>
<div id="question-26" class="section level2">
<h2>Question</h2>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of
mtcars in the list below by using a for loop and lapply(). Can you do it
without an anonymous function?</p>
</div>
<div id="answer-26" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb186-2"><a href="#cb186-2" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb186-3"><a href="#cb186-3" tabindex="-1"></a>mtcars[rows, ]</span>
<span id="cb186-4"><a href="#cb186-4" tabindex="-1"></a>})</span>
<span id="cb186-5"><a href="#cb186-5" tabindex="-1"></a></span>
<span id="cb186-6"><a href="#cb186-6" tabindex="-1"></a><span class="co"># loops</span></span>
<span id="cb186-7"><a href="#cb186-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb186-8"><a href="#cb186-8" tabindex="-1"></a>  <span class="co"># 拟合模型</span></span>
<span id="cb186-9"><a href="#cb186-9" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[<span class="dv">1</span>]], <span class="at">data =</span> bootstraps[[i]])</span>
<span id="cb186-10"><a href="#cb186-10" tabindex="-1"></a>  <span class="co"># 打印模型摘要</span></span>
<span id="cb186-11"><a href="#cb186-11" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Fit result for boot &quot;</span>, i, <span class="st">&quot;:&quot;</span>))</span>
<span id="cb186-12"><a href="#cb186-12" tabindex="-1"></a>  <span class="fu">print</span>(fit)</span>
<span id="cb186-13"><a href="#cb186-13" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Fit result for boot 1:&quot;
## 
## Call:
## lm(formula = formulas[[1]], data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.91398     -0.04125  
## 
## [1] &quot;Fit result for boot 2:&quot;
## 
## Call:
## lm(formula = formulas[[1]], data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.41483     -0.04699  
## 
## [1] &quot;Fit result for boot 3:&quot;
## 
## Call:
## lm(formula = formulas[[1]], data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.64939     -0.04859  
## 
## [1] &quot;Fit result for boot 4:&quot;
## 
## Call:
## lm(formula = formulas[[1]], data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    32.40911     -0.05457  
## 
## [1] &quot;Fit result for boot 5:&quot;
## 
## Call:
## lm(formula = formulas[[1]], data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.26171     -0.03589  
## 
## [1] &quot;Fit result for boot 6:&quot;
## 
## Call:
## lm(formula = formulas[[1]], data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.17913     -0.04133  
## 
## [1] &quot;Fit result for boot 7:&quot;
## 
## Call:
## lm(formula = formulas[[1]], data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.69666     -0.05062  
## 
## [1] &quot;Fit result for boot 8:&quot;
## 
## Call:
## lm(formula = formulas[[1]], data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.7347      -0.0403  
## 
## [1] &quot;Fit result for boot 9:&quot;
## 
## Call:
## lm(formula = formulas[[1]], data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.40919     -0.03749  
## 
## [1] &quot;Fit result for boot 10:&quot;
## 
## Call:
## lm(formula = formulas[[1]], data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     32.1103      -0.0493</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" tabindex="-1"></a><span class="do">##lapply列表</span></span>
<span id="cb188-2"><a href="#cb188-2" tabindex="-1"></a><span class="co">#without an anonymous function</span></span>
<span id="cb188-3"><a href="#cb188-3" tabindex="-1"></a><span class="co">#...    :optional arguments to FUN</span></span>
<span id="cb188-4"><a href="#cb188-4" tabindex="-1"></a>fits2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, lm, <span class="at">formula =</span> formulas[[<span class="dv">1</span>]])</span>
<span id="cb188-5"><a href="#cb188-5" tabindex="-1"></a></span>
<span id="cb188-6"><a href="#cb188-6" tabindex="-1"></a><span class="fu">print</span>(fits2)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.91398     -0.04125  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.41483     -0.04699  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.64939     -0.04859  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    32.40911     -0.05457  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.26171     -0.03589  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.17913     -0.04133  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.69666     -0.05062  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.7347      -0.0403  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.40919     -0.03749  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     32.1103      -0.0493</code></pre>
</div>
<div id="question-27" class="section level2">
<h2>Question</h2>
<p>For each model in the previous two exercises, extract R2 using the
function below.</p>
</div>
<div id="answer-27" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb190-2"><a href="#cb190-2" tabindex="-1"></a><span class="do">## ex3</span></span>
<span id="cb190-3"><a href="#cb190-3" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;R^2 of ex3 model : &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;R^2 of ex3 model : &quot;</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" tabindex="-1"></a><span class="fu">lapply</span>(fits,rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" tabindex="-1"></a><span class="do">## ex4</span></span>
<span id="cb194-2"><a href="#cb194-2" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;R^2 of ex4 model : &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;R^2 of ex4 model : &quot;</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" tabindex="-1"></a><span class="fu">lapply</span>(fits2,rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7285796
## 
## [[2]]
## [1] 0.7442686
## 
## [[3]]
## [1] 0.8245614
## 
## [[4]]
## [1] 0.8024319
## 
## [[5]]
## [1] 0.7382983
## 
## [[6]]
## [1] 0.6167292
## 
## [[7]]
## [1] 0.7310478
## 
## [[8]]
## [1] 0.7685775
## 
## [[9]]
## [1] 0.6517089
## 
## [[10]]
## [1] 0.7910998</code></pre>
</div>
<div id="question-28" class="section level2">
<h2>Question</h2>
<p>The following code simulates the performance of a t-test for
non-normal data. Use sapply() and an anonymous function to extract the
p-value from every trial.</p>
</div>
<div id="answer-28" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb198-2"><a href="#cb198-2" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb198-3"><a href="#cb198-3" tabindex="-1"></a><span class="dv">100</span>,</span>
<span id="cb198-4"><a href="#cb198-4" tabindex="-1"></a><span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb198-5"><a href="#cb198-5" tabindex="-1"></a><span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb198-6"><a href="#cb198-6" tabindex="-1"></a>)</span>
<span id="cb198-7"><a href="#cb198-7" tabindex="-1"></a></span>
<span id="cb198-8"><a href="#cb198-8" tabindex="-1"></a><span class="co">#Use sapply() and an anonymous function</span></span>
<span id="cb198-9"><a href="#cb198-9" tabindex="-1"></a><span class="fu">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 9.813226e-01 1.619096e-05 6.242135e-01 6.693526e-01 5.677105e-01
##   [6] 6.610740e-01 5.951636e-01 5.005347e-01 4.763110e-01 3.429965e-01
##  [11] 8.155394e-01 7.197238e-01 1.244336e-01 2.229164e-01 1.113099e-02
##  [16] 4.625765e-01 6.515865e-01 1.658793e-01 9.342672e-01 8.011934e-01
##  [21] 4.627657e-01 5.927934e-01 2.929669e-01 5.737967e-01 3.451537e-02
##  [26] 2.739138e-01 2.656151e-01 8.196695e-01 6.647355e-01 8.056529e-01
##  [31] 5.060850e-01 7.106543e-01 2.321066e-01 1.106223e-01 5.459279e-01
##  [36] 1.865470e-02 2.433776e-01 2.688851e-01 9.819256e-01 4.940184e-01
##  [41] 3.268275e-01 8.000439e-01 9.822499e-01 1.936454e-01 7.390101e-01
##  [46] 3.888930e-02 4.350424e-01 7.434339e-02 5.787441e-01 4.864951e-01
##  [51] 1.476288e-01 5.524909e-01 7.129280e-01 8.683479e-03 9.053256e-02
##  [56] 4.415463e-01 4.955063e-01 1.745328e-01 6.615399e-01 4.479199e-01
##  [61] 2.885849e-01 3.028567e-02 1.018907e-01 1.811861e-02 6.376441e-01
##  [66] 1.408742e-02 9.008128e-02 4.515933e-01 8.703291e-01 7.250768e-01
##  [71] 8.183571e-01 8.465036e-01 8.786838e-01 1.651543e-01 3.951569e-01
##  [76] 1.754280e-01 3.649865e-01 7.224226e-02 6.565152e-01 9.946559e-01
##  [81] 3.715952e-01 8.424336e-02 4.549887e-01 8.530113e-01 1.970777e-01
##  [86] 2.298117e-01 1.148832e-01 7.769502e-01 4.934348e-01 3.526049e-01
##  [91] 2.036013e-01 8.838914e-01 6.474880e-02 4.089082e-01 5.780132e-01
##  [96] 8.011408e-01 5.956061e-01 9.266689e-01 9.923205e-02 1.763972e-01</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" tabindex="-1"></a><span class="co">#Use sapply() and without anonymous function</span></span>
<span id="cb200-2"><a href="#cb200-2" tabindex="-1"></a><span class="co">#by using [[ directly.</span></span>
<span id="cb200-3"><a href="#cb200-3" tabindex="-1"></a><span class="fu">sapply</span>(trials, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;p.value&quot;</span>)</span></code></pre></div>
<pre><code>##   [1] 9.813226e-01 1.619096e-05 6.242135e-01 6.693526e-01 5.677105e-01
##   [6] 6.610740e-01 5.951636e-01 5.005347e-01 4.763110e-01 3.429965e-01
##  [11] 8.155394e-01 7.197238e-01 1.244336e-01 2.229164e-01 1.113099e-02
##  [16] 4.625765e-01 6.515865e-01 1.658793e-01 9.342672e-01 8.011934e-01
##  [21] 4.627657e-01 5.927934e-01 2.929669e-01 5.737967e-01 3.451537e-02
##  [26] 2.739138e-01 2.656151e-01 8.196695e-01 6.647355e-01 8.056529e-01
##  [31] 5.060850e-01 7.106543e-01 2.321066e-01 1.106223e-01 5.459279e-01
##  [36] 1.865470e-02 2.433776e-01 2.688851e-01 9.819256e-01 4.940184e-01
##  [41] 3.268275e-01 8.000439e-01 9.822499e-01 1.936454e-01 7.390101e-01
##  [46] 3.888930e-02 4.350424e-01 7.434339e-02 5.787441e-01 4.864951e-01
##  [51] 1.476288e-01 5.524909e-01 7.129280e-01 8.683479e-03 9.053256e-02
##  [56] 4.415463e-01 4.955063e-01 1.745328e-01 6.615399e-01 4.479199e-01
##  [61] 2.885849e-01 3.028567e-02 1.018907e-01 1.811861e-02 6.376441e-01
##  [66] 1.408742e-02 9.008128e-02 4.515933e-01 8.703291e-01 7.250768e-01
##  [71] 8.183571e-01 8.465036e-01 8.786838e-01 1.651543e-01 3.951569e-01
##  [76] 1.754280e-01 3.649865e-01 7.224226e-02 6.565152e-01 9.946559e-01
##  [81] 3.715952e-01 8.424336e-02 4.549887e-01 8.530113e-01 1.970777e-01
##  [86] 2.298117e-01 1.148832e-01 7.769502e-01 4.934348e-01 3.526049e-01
##  [91] 2.036013e-01 8.838914e-01 6.474880e-02 4.089082e-01 5.780132e-01
##  [96] 8.011408e-01 5.956061e-01 9.266689e-01 9.923205e-02 1.763972e-01</code></pre>
</div>
<div id="question-29" class="section level2">
<h2>Question</h2>
<p>Implement a combination of Map() and vapply() to create an lapply()
variant that iterates in parallel over all of its inputs and stores its
outputs in a vector (or a matrix). What arguments should the function
take?</p>
</div>
<div id="answer-29" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" tabindex="-1"></a><span class="do">## 编写lapply变形函数--Lappy</span></span>
<span id="cb202-2"><a href="#cb202-2" tabindex="-1"></a><span class="co">#形参：</span></span>
<span id="cb202-3"><a href="#cb202-3" tabindex="-1"></a><span class="co">#FUN--the function to be applied to each element of X</span></span>
<span id="cb202-4"><a href="#cb202-4" tabindex="-1"></a><span class="co">#...--多个X</span></span>
<span id="cb202-5"><a href="#cb202-5" tabindex="-1"></a><span class="co">#FUN.VALUE  --a (generalized) vector; a template for the return value from FUN</span></span>
<span id="cb202-6"><a href="#cb202-6" tabindex="-1"></a>Lapply<span class="ot">&lt;-</span><span class="cf">function</span>(FUN, ..., <span class="at">FUN.VALUE=</span><span class="fu">numeric</span>(<span class="dv">1</span>), <span class="at">sim =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb202-7"><a href="#cb202-7" tabindex="-1"></a>  <span class="co"># 使用Map实现对...中的每个元的并行</span></span>
<span id="cb202-8"><a href="#cb202-8" tabindex="-1"></a>  re <span class="ot">&lt;-</span> <span class="fu">Map</span>(FUN, ...)</span>
<span id="cb202-9"><a href="#cb202-9" tabindex="-1"></a>  <span class="co"># vapply</span></span>
<span id="cb202-10"><a href="#cb202-10" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">vapply</span>(re, <span class="cf">function</span>(x) {</span>
<span id="cb202-11"><a href="#cb202-11" tabindex="-1"></a>    <span class="co"># 使用FUN.VALUE[[1]]为模板</span></span>
<span id="cb202-12"><a href="#cb202-12" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(FUN.VALUE) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb202-13"><a href="#cb202-13" tabindex="-1"></a>      <span class="fu">return</span>(x[[<span class="dv">1</span>]])</span>
<span id="cb202-14"><a href="#cb202-14" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb202-15"><a href="#cb202-15" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;FUN.VALUE must be a vector of length 1&quot;</span>)</span>
<span id="cb202-16"><a href="#cb202-16" tabindex="-1"></a>    }</span>
<span id="cb202-17"><a href="#cb202-17" tabindex="-1"></a>  }, FUN.VALUE)</span>
<span id="cb202-18"><a href="#cb202-18" tabindex="-1"></a>  </span>
<span id="cb202-19"><a href="#cb202-19" tabindex="-1"></a>  <span class="co"># 如果simplify为TRUE且结果为一维，则简化输出为向量</span></span>
<span id="cb202-20"><a href="#cb202-20" tabindex="-1"></a>  <span class="cf">if</span> (sim <span class="sc">&amp;&amp;</span> <span class="fu">is.list</span>(res) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(res) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb202-21"><a href="#cb202-21" tabindex="-1"></a>    <span class="fu">return</span>(res[[<span class="dv">1</span>]])</span>
<span id="cb202-22"><a href="#cb202-22" tabindex="-1"></a>  }</span>
<span id="cb202-23"><a href="#cb202-23" tabindex="-1"></a>  </span>
<span id="cb202-24"><a href="#cb202-24" tabindex="-1"></a>  <span class="co"># 返回结果</span></span>
<span id="cb202-25"><a href="#cb202-25" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb202-26"><a href="#cb202-26" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" tabindex="-1"></a><span class="do">##举例使用上述函数</span></span>
<span id="cb203-2"><a href="#cb203-2" tabindex="-1"></a>my_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb203-3"><a href="#cb203-3" tabindex="-1"></a>  x <span class="sc">^</span> y</span>
<span id="cb203-4"><a href="#cb203-4" tabindex="-1"></a>}</span>
<span id="cb203-5"><a href="#cb203-5" tabindex="-1"></a></span>
<span id="cb203-6"><a href="#cb203-6" tabindex="-1"></a><span class="co"># 并行应用myFUN到两个向量上</span></span>
<span id="cb203-7"><a href="#cb203-7" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">Lapply</span>(my_fun, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>),<span class="at">sim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb203-8"><a href="#cb203-8" tabindex="-1"></a></span>
<span id="cb203-9"><a href="#cb203-9" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb203-10"><a href="#cb203-10" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## [1]   1  32 729</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" tabindex="-1"></a><span class="fu">is.vector</span>(result)<span class="sc">|</span><span class="fu">is.matrix</span>(result)<span class="co">#检验结果是否向量/矩阵形式</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="question-30" class="section level2">
<h2>Question</h2>
<p>Make a faster version of chisq.test() that only computes the
chi-square test statistic when the input is two numeric vectors with no
missing values.</p>
</div>
<div id="answer-30" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" tabindex="-1"></a><span class="co">#编写更快的检验函数</span></span>
<span id="cb207-2"><a href="#cb207-2" tabindex="-1"></a>my_chisq.test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb207-3"><a href="#cb207-3" tabindex="-1"></a>  <span class="co"># 默认确保输入是数值型向量且无缺失值</span></span>
<span id="cb207-4"><a href="#cb207-4" tabindex="-1"></a>  <span class="co"># 根据卡方检验公式，尽量向量化</span></span>
<span id="cb207-5"><a href="#cb207-5" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb207-6"><a href="#cb207-6" tabindex="-1"></a>  obs <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(tab)</span>
<span id="cb207-7"><a href="#cb207-7" tabindex="-1"></a>  <span class="do">##利用outer外积</span></span>
<span id="cb207-8"><a href="#cb207-8" tabindex="-1"></a>  exp <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="fu">rowSums</span>(tab), <span class="fu">colSums</span>(tab)) <span class="sc">/</span> <span class="fu">sum</span>(tab)</span>
<span id="cb207-9"><a href="#cb207-9" tabindex="-1"></a>  <span class="co"># 卡方检验统计量</span></span>
<span id="cb207-10"><a href="#cb207-10" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">sum</span>((obs <span class="sc">-</span> exp)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> exp)</span>
<span id="cb207-11"><a href="#cb207-11" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb207-12"><a href="#cb207-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" tabindex="-1"></a><span class="do">##举例使用上述函数</span></span>
<span id="cb208-2"><a href="#cb208-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb208-3"><a href="#cb208-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">50</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb208-4"><a href="#cb208-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">50</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb208-5"><a href="#cb208-5" tabindex="-1"></a></span>
<span id="cb208-6"><a href="#cb208-6" tabindex="-1"></a><span class="co"># 计算卡方检验统计量</span></span>
<span id="cb208-7"><a href="#cb208-7" tabindex="-1"></a><span class="fu">my_chisq.test</span>(x, y)</span></code></pre></div>
<pre><code>## [1] 60.23639</code></pre>
</div>
<div id="question-31" class="section level2">
<h2>Question</h2>
<p>make a faster version of table() for the case of an input of two
integer vectors with no missing values</p>
<p>use it to speed up your chi-square test</p>
</div>
<div id="answer-31" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" tabindex="-1"></a><span class="do">## mytab：</span></span>
<span id="cb210-2"><a href="#cb210-2" tabindex="-1"></a>mytab <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb210-3"><a href="#cb210-3" tabindex="-1"></a>  </span>
<span id="cb210-4"><a href="#cb210-4" tabindex="-1"></a>  <span class="co"># 去重</span></span>
<span id="cb210-5"><a href="#cb210-5" tabindex="-1"></a>  unique_x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(x))</span>
<span id="cb210-6"><a href="#cb210-6" tabindex="-1"></a>  unique_y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(y))</span>
<span id="cb210-7"><a href="#cb210-7" tabindex="-1"></a>  <span class="co"># 计算频数矩阵</span></span>
<span id="cb210-8"><a href="#cb210-8" tabindex="-1"></a>  xcol<span class="ot">&lt;-</span><span class="cf">function</span>(i){</span>
<span id="cb210-9"><a href="#cb210-9" tabindex="-1"></a>    <span class="fu">sapply</span>(unique_y,<span class="cf">function</span>(j) <span class="fu">sum</span>(y[x<span class="sc">==</span>i]<span class="sc">==</span>j))</span>
<span id="cb210-10"><a href="#cb210-10" tabindex="-1"></a>  } <span class="co">#向量化，得到第i行</span></span>
<span id="cb210-11"><a href="#cb210-11" tabindex="-1"></a>  freq<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">sapply</span>(unique_x,xcol)))</span>
<span id="cb210-12"><a href="#cb210-12" tabindex="-1"></a>  <span class="fu">rownames</span>(freq)<span class="ot">&lt;-</span>unique_x</span>
<span id="cb210-13"><a href="#cb210-13" tabindex="-1"></a>  <span class="fu">colnames</span>(freq)<span class="ot">&lt;-</span>unique_y</span>
<span id="cb210-14"><a href="#cb210-14" tabindex="-1"></a>  <span class="co"># 返回频数向量</span></span>
<span id="cb210-15"><a href="#cb210-15" tabindex="-1"></a>  <span class="fu">return</span>(freq)</span>
<span id="cb210-16"><a href="#cb210-16" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" tabindex="-1"></a><span class="do">##举例使用上述函数</span></span>
<span id="cb211-2"><a href="#cb211-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">50</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb211-3"><a href="#cb211-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">50</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb211-4"><a href="#cb211-4" tabindex="-1"></a><span class="fu">mytab</span>(x,y) <span class="co">#行名为x，列为y</span></span></code></pre></div>
<pre><code>##   3 4 5 6 7 8
## 2 0 3 0 0 0 0
## 3 0 1 1 2 1 3
## 4 2 1 1 2 2 1
## 5 0 1 1 1 2 2
## 6 1 0 0 3 2 1
## 7 6 1 3 2 2 2</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" tabindex="-1"></a><span class="fu">table</span>(x,y)<span class="co">#验证和table结果相同</span></span></code></pre></div>
<pre><code>##    y
## x   3 4 5 6 7 8
##   2 0 3 0 0 0 0
##   3 0 1 1 2 1 3
##   4 2 1 1 2 2 1
##   5 0 1 1 1 2 2
##   6 1 0 0 3 2 1
##   7 6 1 3 2 2 2</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" tabindex="-1"></a><span class="co">#use it to speed up your chi-square test?</span></span>
<span id="cb215-2"><a href="#cb215-2" tabindex="-1"></a></span>
<span id="cb215-3"><a href="#cb215-3" tabindex="-1"></a>my_chisq.test2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb215-4"><a href="#cb215-4" tabindex="-1"></a>  <span class="co"># 默认确保输入是数值型向量且无缺失值</span></span>
<span id="cb215-5"><a href="#cb215-5" tabindex="-1"></a>  <span class="co"># 根据卡方检验公式，尽量向量化</span></span>
<span id="cb215-6"><a href="#cb215-6" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="fu">mytab</span>(x, y)</span>
<span id="cb215-7"><a href="#cb215-7" tabindex="-1"></a>  obs <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(tab)</span>
<span id="cb215-8"><a href="#cb215-8" tabindex="-1"></a>  <span class="do">##利用outer外积</span></span>
<span id="cb215-9"><a href="#cb215-9" tabindex="-1"></a>  exp <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="fu">rowSums</span>(tab), <span class="fu">colSums</span>(tab)) <span class="sc">/</span> <span class="fu">sum</span>(tab)</span>
<span id="cb215-10"><a href="#cb215-10" tabindex="-1"></a>  <span class="co"># 卡方检验统计量</span></span>
<span id="cb215-11"><a href="#cb215-11" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">sum</span>((obs <span class="sc">-</span> exp)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> exp)</span>
<span id="cb215-12"><a href="#cb215-12" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb215-13"><a href="#cb215-13" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" tabindex="-1"></a><span class="do">##举例使用上述函数</span></span>
<span id="cb216-2"><a href="#cb216-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb216-3"><a href="#cb216-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">50</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb216-4"><a href="#cb216-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">50</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb216-5"><a href="#cb216-5" tabindex="-1"></a></span>
<span id="cb216-6"><a href="#cb216-6" tabindex="-1"></a><span class="co"># 计算卡方检验统计量</span></span>
<span id="cb216-7"><a href="#cb216-7" tabindex="-1"></a><span class="fu">my_chisq.test2</span>(x, y)<span class="co">#结果是相同的，速度增大了</span></span></code></pre></div>
<pre><code>## [1] 60.23639</code></pre>
</div>
</div>
<div id="hw9" class="section level1">
<h1>hw9</h1>
<div id="question-32" class="section level2">
<h2>Question</h2>
<p>Write an Rcpp function for Exercise 9.8</p>
</div>
<div id="answer-32" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" tabindex="-1"></a><span class="co">#the R function</span></span>
<span id="cb219-2"><a href="#cb219-2" tabindex="-1"></a>gibb<span class="ot">&lt;-</span><span class="cf">function</span>(m,cut,<span class="at">n=</span><span class="dv">10</span>,<span class="at">a=</span><span class="dv">1</span>,<span class="at">b=</span><span class="dv">1</span>){</span>
<span id="cb219-3"><a href="#cb219-3" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb219-4"><a href="#cb219-4" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb219-5"><a href="#cb219-5" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb219-6"><a href="#cb219-6" tabindex="-1"></a>  y[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,x[<span class="dv">1</span>]<span class="sc">+</span>a,n<span class="sc">-</span>x[<span class="dv">1</span>]<span class="sc">+</span>b)</span>
<span id="cb219-7"><a href="#cb219-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb219-8"><a href="#cb219-8" tabindex="-1"></a>    x[i]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,y[i<span class="dv">-1</span>])</span>
<span id="cb219-9"><a href="#cb219-9" tabindex="-1"></a>    y[i]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>]<span class="sc">+</span>a,n<span class="sc">-</span>x[i<span class="dv">-1</span>]<span class="sc">+</span>b)</span>
<span id="cb219-10"><a href="#cb219-10" tabindex="-1"></a>  }</span>
<span id="cb219-11"><a href="#cb219-11" tabindex="-1"></a>  x<span class="ot">&lt;-</span>x[(cut<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m]</span>
<span id="cb219-12"><a href="#cb219-12" tabindex="-1"></a>  y<span class="ot">&lt;-</span>y[(cut<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m]</span>
<span id="cb219-13"><a href="#cb219-13" tabindex="-1"></a>  f<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(x,y),<span class="at">nrow =</span> (m<span class="sc">-</span>cut),<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb219-14"><a href="#cb219-14" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" tabindex="-1"></a><span class="co">#相应的C++版本,具体可见压缩包中的gibbs.cpp</span></span>
<span id="cb220-2"><a href="#cb220-2" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb220-3"><a href="#cb220-3" tabindex="-1"></a>dir_cpp <span class="ot">&lt;-</span> <span class="st">&#39;D:/Download/RStudio/R-4.2.2/library/Rcpp/myfun/&#39;</span></span>
<span id="cb220-4"><a href="#cb220-4" tabindex="-1"></a><span class="co">#路径</span></span>
<span id="cb220-5"><a href="#cb220-5" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="fu">paste0</span>(dir_cpp,<span class="st">&quot;gibbs.cpp&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" tabindex="-1"></a><span class="co"># 生成1000个数据的MC</span></span>
<span id="cb221-2"><a href="#cb221-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb221-3"><a href="#cb221-3" tabindex="-1"></a>g_c<span class="ot">&lt;-</span><span class="fu">gibbs</span>(<span class="dv">2000</span>,<span class="dv">1000</span>) <span class="co">#Rcpp</span></span>
<span id="cb221-4"><a href="#cb221-4" tabindex="-1"></a>g_r<span class="ot">&lt;-</span><span class="fu">gibb</span>(<span class="dv">2000</span>,<span class="dv">1000</span>)  <span class="co">#R function</span></span></code></pre></div>
</div>
<div id="question-33" class="section level2">
<h2>Question</h2>
<p>Compare the corresponding generated random numbers with those by the
R function you wrote using the function “qqplot”.</p>
</div>
<div id="answer-33" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" tabindex="-1"></a><span class="co">#Compare the corresponding generated random numbers </span></span>
<span id="cb222-2"><a href="#cb222-2" tabindex="-1"></a><span class="co">#with those by the R function </span></span>
<span id="cb222-3"><a href="#cb222-3" tabindex="-1"></a><span class="co">#对x分量标准化以便画qq图</span></span>
<span id="cb222-4"><a href="#cb222-4" tabindex="-1"></a>g_c[,<span class="dv">1</span>]<span class="ot">&lt;-</span>(g_c[,<span class="dv">1</span>]<span class="sc">-</span><span class="fu">min</span>(g_c[,<span class="dv">1</span>]))<span class="sc">/</span>(<span class="fu">max</span>(g_c[,<span class="dv">1</span>])<span class="sc">-</span><span class="fu">min</span>(g_c[,<span class="dv">1</span>]))</span>
<span id="cb222-5"><a href="#cb222-5" tabindex="-1"></a>g_r[,<span class="dv">1</span>]<span class="ot">&lt;-</span>(g_r[,<span class="dv">1</span>]<span class="sc">-</span><span class="fu">min</span>(g_r[,<span class="dv">1</span>]))<span class="sc">/</span>(<span class="fu">max</span>(g_r[,<span class="dv">1</span>])<span class="sc">-</span><span class="fu">min</span>(g_r[,<span class="dv">1</span>]))</span>
<span id="cb222-6"><a href="#cb222-6" tabindex="-1"></a><span class="fu">qqplot</span>(g_c[,<span class="dv">1</span>],g_r[,<span class="dv">1</span>],<span class="at">main=</span><span class="st">&quot;x--qqplot&quot;</span>)</span>
<span id="cb222-7"><a href="#cb222-7" tabindex="-1"></a><span class="fu">qqplot</span>(g_c[,<span class="dv">2</span>],g_r[,<span class="dv">2</span>],<span class="at">main=</span><span class="st">&quot;y--qqplot&quot;</span>)</span></code></pre></div>
<p>其中x是0到10的离散分布，故为第一个图所示；</p>
<p>上述两个QQ图可见两种方法生成的该分布可视为同分布</p>
</div>
<div id="question-34" class="section level2">
<h2>Question</h2>
<p>Campare the computation time of the two functions with the function
“microbenchmark”.</p>
</div>
<div id="answer-34" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" tabindex="-1"></a><span class="co">#m=5000</span></span>
<span id="cb223-2"><a href="#cb223-2" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb223-3"><a href="#cb223-3" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gC=</span><span class="fu">gibbs</span>(<span class="dv">5000</span>,<span class="dv">1000</span>),<span class="at">gR=</span><span class="fu">gibb</span>(<span class="dv">5000</span>,<span class="dv">1000</span>))</span>
<span id="cb223-4"><a href="#cb223-4" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<p>综上所述，用C语言的gibbs函数和原有R函数生成随机数结果相近，都能生成符合条件的随机数；</p>
<p>但C语言的gibbs函数用时明显少于原有R函数，运行速率更高。</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
